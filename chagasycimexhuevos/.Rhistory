#                 width=.1)+
#   geom_line(aes(group=c(infected))) +
#   ggtitle("Average Hatch Rate Each Week By Insects that Laid in Rep 2")+
#   xlab("Week") +
#   ylab("Average Percentage of Eggs that Hatched")+
#   scale_color_discrete(name="Infection Status", labels=c("Controls", "Infected"), h= c(250, 3))+
#   geom_point()
# h3c
#
#
# dev.off()
#
# par(mfrow=c(1,1))
#create a factor id for mice for STATA
mice<-unique(Compile$mouse)
mouseidnum<-c(1:length(mice))
mousetable<-data.frame(mice,mouseidnum)
mousetable$mouseidnum<-as.factor(mousetable$mouseidnum)
Compile$mouseidnum<-Compile$trial*0
for(i in 1:length(mice)){
micenumi<-which(mousetable$mouseidnum==i)
micematch<-which(Compile$mouse==mousetable$mice[micenumi])
Compile$mouseidnum[micematch]<-i
}
# ##create total values for each insect
# #create rows to fill by loop
Compile$lifespan<-Compile$eggs*NA
Compile$egg_total<-Compile$eggs*NA
Compile$hatch_total<-Compile$eggs*NA
Compile$avmaxtemp<-Compile$eggs*NA
Compile$avmintemp<-Compile$eggs*NA
Compile$avmaxhum<-Compile$eggs*NA
Compile$avminhum<-Compile$eggs*NA
Compile$havmaxtemp<-Compile$eggs*NA
Compile$havmintemp<-Compile$eggs*NA
Compile$havmaxhum<-Compile$eggs*NA
Compile$havminhum<-Compile$eggs*NA
#make temperature and humidity values numeric
tempRH$TEMP.MAX..Â.C.<-as.numeric(tempRH$TEMP.MAX..Â.C.)
tempRH$TEMP.MIN..Â.C.<-as.numeric(tempRH$TEMP.MIN..Â.C.)
tempRH$HR.MAX....<-as.numeric(tempRH$HR.MAX....)
tempRH$HR.MIN....<-as.numeric(tempRH$HR.MIN....)
# #identify living observations so temperatures while the
# #insect is dead does not have affect
lives <- which(Compile$alive==1)
#identify observations that have eggs laid
eggslaid <- which(Compile$eggs > 0)
# #loop over each insect and calculate lifespan and temperature variables
for (i in 1:max(Compile$idnum)) {
ids<-which(Compile$idnum==i)
#Sum eggs laid and hatched across life of bug
Compile$egg_total[ids]<-sum(Compile$eggs[ids], na.rm=TRUE)
Compile$hatch_total[ids]<-sum(Compile$hatch[ids], na.rm=TRUE)
is <- intersect(ids, lives)#that way you don't add dead times to observations
#the number of observations while alive == lifespan
ls<-length(is)
#identify the first and last observations in [is]
fst<-is[1]
lst<-is[ls]
#Put the calculated items into the appropriate vectors of data frame
Compile$lifespan[ids]<-ls
#identify first and last date for each insect.
begin<-(Compile$start[fst])
end<-Compile$date[lst]
a<-which(tempRH$FECHA==begin)
b<-which(tempRH$FECHA==end)
#Use dates to find values from temperature and humidity data
#average over the life of the bug.
avmaxtemp1<-mean(tempRH$TEMP.MAX..Â.C.[a:b], na.rm=TRUE)
avmintemp1<-mean(tempRH$TEMP.MIN..Â.C.[a:b], na.rm=TRUE)
avmaxhum1<-mean(tempRH$HR.MAX....[a:b], na.rm=TRUE)
avminhum1<-mean(tempRH$HR.MIN....[a:b], na.rm=TRUE)
#Now add these to Compile
Compile$avmaxtemp[ids]<-avmaxtemp1
Compile$avmintemp[ids]<-avmintemp1
Compile$avmaxhum[ids]<-avmaxhum1
Compile$avminhum[ids]<-avminhum1
}
#now make a similar calculation for humidity, only using weeks where eggs were laid
for (i in 1:max(Compile$idnum)) {
ids<-which(Compile$idnum==i)
leggs <- intersect(ids, eggslaid)
if(length(leggs) > 0){
#create a list of dates
FECHA<-NA
for (j in 1:length(leggs)){
endings <- Compile$date[leggs[j]]
beginings <- (Compile$date[leggs[j]])-6
moredates<-(beginings:endings)
FECHA<-c(FECHA, moredates)
}
num<-1:length(FECHA)
datetable<-data.frame(num, FECHA)
#merge temperature data onto datetable
temptable<-merge(datetable, tempRH, by="FECHA", all.x=TRUE)
#take the average of each of these columns
havmaxtemp1 <- mean(temptable$TEMP.MAX..Â.C., na.rm=TRUE)
havmintemp1 <- mean(temptable$TEMP.MIN..Â.C., na.rm=TRUE)
havmaxhum1 <- mean(temptable$HR.MAX...., na.rm=TRUE)
havminhum1 <- mean(temptable$HR.MIN...., na.rm=TRUE)
#Now add these to Compile
Compile$havmaxtemp[ids] <- havmaxtemp1
Compile$havmintemp[ids] <- havmintemp1
Compile$havmaxhum[ids] <- havmaxhum1
Compile$havminhum[ids] <- havminhum1
}
}
#finally lets reduce the table down to only the lifespan data
weekone<-which(Compile$week==1)
FFdata<-Compile[weekone,]
#remove duplicate or week specific columns
FFdata$id<- NULL
FFdata$sdweek<- NULL
FFdata$procedencia<- NULL
FFdata$mouse<- NULL
FFdata$alive<- NULL
FFdata$date<- NULL
FFdata$week<- NULL
FFdata$start<- NULL
FFdata$id<- NULL
FFdata$parents<- NULL
FFdata$eggs<- NULL
FFdata$hatch<- NULL
#save as a csv
#write.csv("FertilityFecundityFinalData.csv")
###############################################################################
#==============================================================================
#ahora tenomos muchas graficas, podemos empezar haciendo el modelo
#########################################################
#getting model data
#[1]coefficient
#[2]residuals
#[3]fitted values
#[4]effects?
#[5]R
#[8]Link Function and NB value
#[10] deviance
#[11]AIC
#[14]Weights
#Model with infection and infection as covariates.
lifespanmod<-glm.nb(egg_total~infected+lifespan, data=FFdata)
summary(lifespanmod)
plot(lifespanmod)
plot(residuals(lifespanmod))
nullhmodel<- glm(hatch_total~infected, data=FFdata, offset(egg_total),family="poisson")
summary(nullhmodel)  #AIC==182496
plot(nullmodel)
lifespanmod<-glm.nb(egg_total~infected+lifespan, data=FFdata)
summary(lifespanmod)
plot(lifespanmod)
nullmodel<- glm.nb(egg_total~infected, data=FFdata, offset(lifespan))
summary(nullmodel)  #AIC==26710   P=<2e-16 ***
plot(nullmodel)
maxtempmodel<- glm.nb(egg_total~avmaxtemp, data=FFdata, offset(lifespan))
mintempmodel<- glm.nb(egg_total~avmintemp, data=FFdata, offset(lifespan))
maxhummodel<- glm.nb(egg_total~avmaxhum, data=FFdata, offset(lifespan))
minhummodel<- glm.nb(egg_total~avminhum, data=FFdata, offset(lifespan))
summary(maxtempmodel)  #AIC==26605
summary(mintempmodel) #AIC==26781  (null model is a better model)
summary(maxhummodel) #AIC==26744  (null model is a better model)
summary(minhummodel) #AIC==26812
selectedmodel<-glm.nb(egg_total~infected+avmaxtemp+avminhum, data=FFdata, offset(lifespan))
summary(selectedmodel)  #AIC==26366   P(infection)==< 2e-16 *** (worse than full model)
fullmodel<-glm.nb(egg_total~infected+avmaxtemp+avminhum+avmaxhum+avmintemp, data=FFdata, offset(lifespan))
summary(fullmodel) #AIC==26040 (worse than full model)
AltModelD<-glm.nb(egg_total~infected+avminhum+avmaxhum, data=FFdata, offset(lifespan))
summary(AltModelC) #AIC==26417
AltModelD<-glm.nb(egg_total~infected+avminhum+avmaxhum, data=FFdata, offset(lifespan))
summary(AltModelD) #AIC==26417
AltModelD<-glm.nb(egg_total~infected+avmintemp+avmaxtemp, data=FFdata, offset(lifespan))
summary(AltModelE) #AIC==26417
AltModelD<-glm.nb(egg_total~infected+avminhum+avmaxhum, data=FFdata, offset(lifespan))
summary(AltModelD) #AIC==26417
AltModelE<-glm.nb(egg_total~infected+avmintemp+avmaxtemp, data=FFdata, offset(lifespan))
summary(AltModelE) #AIC==26417
AltModelF<-glm.nb(egg_total~infected+avmintemp+avmaxtemp+avminhum, data=FFdata, offset(lifespan))
summary(AltModelF) #AIC==
AltModelG<-glm.nb(egg_total~infected+avmintemp+avmaxtemp+avmaxhum, data=FFdata, offset(lifespan))
summary(AltModelG) #AIC==
AltModelH<-glm.nb(egg_total~infected+avmintemp+avmaxhum+avminhum, data=FFdata, offset(lifespan))
summary(AltModelH) #AIC==
AltModelI<-glm.nb(egg_total~infected+avmaxhum+avmaxtemp+avminhum, data=FFdata, offset(lifespan))
summary(AltModelI) #AIC==
AltModelF<-glm.nb(egg_total~infected+avmintemp+avmaxtemp+avminhum, data=FFdata, offset(lifespan))
summary(AltModelF) #AIC==
AltModelG<-glm.nb(egg_total~infected+avmintemp+avmaxtemp+avmaxhum, data=FFdata, offset(lifespan))
summary(AltModelG) #AIC==
AltModelH<-glm.nb(egg_total~infected+avmintemp+avmaxhum+avminhum, data=FFdata, offset(lifespan))
summary(AltModelH) #AIC==
2*log(0.05)
fullmodel
exp(0.4846)
FFdata$hatchproportion<-FFdata$hatch_total/FFdata$egg_total
mean(FFdata$hatchproportion)
mean(FFdata$hatchproportion,na.rm=TRUE)
var(FFdata$hatchproportion,na.rm=TRUE)
plot(FFdata$hatchproportion, FFdata$lifespan)
plot(FFdata$lifespan, FFdata$hatchproportion)
hist(hatchproportion)
hist(FFdata$hatchproportion)
hist(FFdata$hatchproportion[which(FFdata$infected==1)])
hist(FFdata$hatchproportion[which(FFdata$infected==0)])
nullhmodel<- glm(hatch_total~infected, data=FFdata, offset(egg_total),family="poisson")
summary(nullhmodel)  #AIC==182496
nullhmodelB<- glm(hatch_total~infected+lifespan, data=FFdata, offset(egg_total),family="poisson")
summary(nullhmodel) #AIC==
nullhmodelB<- glm(hatch_total~infected+lifespan, data=FFdata, offset(egg_total),family="poisson")
summary(nullhmodelB) #AIC==340734
###Now just do a univariate analysis
hmaxtempmodel<- glm(hatch_total~havmaxtemp, data=FFdata, offset(egg_total),family="poisson")
hmintempmodel<- glm(hatch_total~havmintemp, data=FFdata, offset(egg_total),family="poisson")
hmaxhummodel<- glm(hatch_total~havmaxhum, data=FFdata, offset(egg_total),family="poisson")
hminhummodel<- glm(hatch_total~havminhum, data=FFdata, offset(egg_total),family="poisson")
summary(hmaxtempmodel)  #AIC==336158
summary(hmintempmodel) #AIC==373140
summary(hmaxhummodel) #AIC==307829
summary(hminhummodel) #AIC==  304791
fullmodel<- glm(hatch_total~infected+lifespan+havminhum+havmaxhum+havmintemp+havmaxtemp,data=FFdata, offset(egg_total),family="poisson")
summary(fullmodel) #AIC==167222
hmaxtempmodel[5]
summary(hminhummodel) #AIC==  304791
plot(hmaxtempmodel)
plot(hmintempmodel)
hmaxtempmodel
pRsq<-as.function(nulldev, residdev) {
pseudoRsq<-1-(nulldev/residdev)
pseudoRsq
}
?as.function
?function
>
#pseudo R-squared
pRsq<-function(nulldev, residdev) {
pseudoRsq<-1-(nulldev/residdev)
pseudoRsq
}
pRsq(hmaxtempmodel)
pRsq(hmaxtempmodel$null.deviance, hmaxtempmodel$deviance)
fullmodel<- glm(hatch_total~infected+lifespan+havminhum+havmaxhum+havmintemp+havmaxtemp,data=FFdata, offset(egg_total),family="poisson")
summary(fullmodel) #AIC==167222
fullmodel<- glm(hatch_total~infected+lifespan+havminhum+havmaxhum+havmintemp+havmaxtemp,offset(egg_total),data=FFdata, offset(egg_total),family="poisson")
summary(fullmodel) #AIC==167222
hcmaxtempmodel<- glm(hatch_total~infected+lifespan+havmaxtemp, data=FFdata, offset(egg_total),family="poisson")
hcmaxtempmodel<- glm(hatch_total~infected+lifespan+havmaxtemp, data=FFdata, offset(egg_total),family="poisson")
hcmintempmodel<- glm(hatch_total~infected+lifespan+havmintemp, data=FFdata, offset(egg_total),family="poisson")
hcmaxhummodel<- glm(hatch_total~infected+lifespan+havmaxhum, data=FFdata, offset(egg_total),family="poisson")
hcminhummodel<- glm(hatch_total~infected+lifespan+havminhum, data=FFdata, offset(egg_total),family="poisson")
summary(hcmaxtempmodel)
summary(hcmintempmodel) #AIC==
summary(hcmaxhummodel) #AIC==
summary(hcminhummodel) #AIC==
hAltModelH<-glm.nb(hatch_total~infected+lifespan+havminhum+havmaxhum, data=FFdata, offset(egg_total))
summary(hAltModelH) #AIC==
hAltModelI<-glm.nb(hatch_total~infected+lifespan+havmintemp+havmaxtemp, data=FFdata, offset(egg_total))
summary(hAltModelI) #AIC==
summary(hAltModelD) #AIC==93113
hAltModelD<-glm.nb(hatch_total~infected+lifespan+havmaxtemp+havmintemp+havminhum, data=FFdata, offset(egg_total))
hAltModelE<-glm.nb(hatch_total~infected+lifespan+havmaxtemp+havmintemp+havmaxhum, data=FFdata, offset(egg_total))
hAltModelF<-glm.nb(hatch_total~infected+lifespan+havmaxtemp+havmaxhum+havminhum, data=FFdata, offset(egg_total))
hAltModelG<-glm.nb(hatch_total~infected+lifespan+havmaxhum+havmintemp+havminhum, data=FFdata, offset(egg_total))
summary(hAltModelD) #AIC==
summary(hAltModelE)#AIC==
summary(hAltModelF)#AIC==
summary(hAltModelG)#AIC==
fullmodel<- glm(hatch_total~infected+lifespan+havminhum+havmaxhum+havmintemp+havmaxtemp,offset(egg_total),data=FFdata, offset(egg_total),family="poisson")
summary(fullmodel) #AIC==148245
lrtest(hAltModelF, hAltModelG)
?lrtest
lrtest(hAltModelF, hAltModelH)
lrtest(hAltModelG, hAltModelH)  #
lrtest(hAltModelG, hAltModelH)  #
lrtest(hAltModelH, hAltModelG)  #
lrtest(hAltModelF, hAltModelG)  #significant
fullmodel<- glm(hatch_total~infected+lifespan+havminhum+havmaxhum+havmintemp+havmaxtemp,offset(egg_total),data=FFdata, offset(egg_total),family="poisson")
fullmodel
summary(fullmodel)
lrtest(hAltModelF,hAltModelB)
hAltModelA<-glm.nb(hatch_total~infected+lifespan+havmintemp+havminhum, data=FFdata, offset(egg_total))
summary(hAltModelA) #AIC==93113
#Alternative models 2 Variables
hAltModelA<-glm.nb(hatch_total~infected+lifespan+havmintemp+havminhum, data=FFdata, offset(egg_total))
summary(hAltModelA) #AIC==93113
hAltModelB<-glm.nb(hatch_total~infected+lifespan+havmaxtemp+havmaxhum, data=FFdata, offset(egg_total))
summary(hAltModelB) #AIC==93261
hAltModelC<-glm.nb(hatch_total~infected+lifespan+havmintemp+havmaxhum, data=FFdata, offset(egg_total))
summary(hAltModelC) #AIC== 93221
hAltModelH<-glm.nb(hatch_total~infected+lifespan+havminhum+havmaxhum, data=FFdata, offset(egg_total))
summary(hAltModelH) #AIC== 92749**
hAltModelI<-glm.nb(hatch_total~infected+lifespan+havmintemp+havmaxtemp, data=FFdata, offset(egg_total))
summary(hAltModelI) #AIC==93025
lrtest(hAltModelF, hselectedmodel)#barely non significant(P==0.06278)
hselectedmodel<-glm.nb(hatch_total~infected+lifespan+havmaxtemp+havminhum, data=FFdata, offset(egg_total))
lrtest(hAltModelF, hselectedmodel)#barely non significant(P==0.06278)
lrtest(hAltModelF, hAltModelB)  #barely non significant(P==0.06278)
fullmodel<- glm(hatch_total~infected+lifespan+havminhum+havmaxhum+havmintemp+havmaxtemp,offset(egg_total),data=FFdata, offset(egg_total),family="poisson")
summary(fullmodel) #AIC==148245
hfullmodel<- glm(hatch_total~infected+havminhum+havmaxhum+havmintemp+havmaxtemp,offset(egg_total),data=FFdata, offset(egg_total),family="poisson")
summary(hfullmodel) #AIC==148245
hfullmodel[5]
hAltModelF
summary(hAltModelF)
summary(hAltModelB)
nullhmodel<- glm(hatch_total~infected, data=FFdata, offset(egg_total),family="poisson")
summary(nullhmodel)  #AIC==340734
nullhmodel<- glm(hatch_total~infected, data=FFdata, offset(egg_total),family="poisson")
summary(nullhmodel)  #AIC==340734
nullhmodelB<- glm(hatch_total~infected+lifespan, data=FFdata, offset(egg_total),family="poisson")
summary(nullhmodelB) #AIC==179486,and thus significantly beneficial
hmaxtempmodel<- glm(hatch_total~havmaxtemp, data=FFdata, offset(egg_total),family="poisson")
hmintempmodel<- glm(hatch_total~havmintemp, data=FFdata, offset(egg_total),family="poisson")
hmaxhummodel<- glm(hatch_total~havmaxhum, data=FFdata, offset(egg_total),family="poisson")
hminhummodel<- glm(hatch_total~havminhum, data=FFdata, offset(egg_total),family="poisson")
#pseudo R-squared
pRsq<-function(nulldev, residdev) {
pseudoRsq<-1-(nulldev/residdev)
pseudoRsq
}
hmaxtempmodel
hmintempmodel
summary(hmaxtempmodel)  #AIC==336158
pRsq(hmaxtempmodel$null.deviance, hmaxtempmodel$deviance)#
plot(hmaxtempmodel)
summary(hmaxtempmodel)  #AIC==336158
pRsq(hmaxtempmodel$null.deviance, hmaxtempmodel$deviance)#
pRsq<-function(nulldev, residdev) {
pseudoRsq<-1-(reidevdev/nulldev)
pseudoRsq
}
summary(hmaxtempmodel)  #AIC==336158
pRsq(hmaxtempmodel$null.deviance, hmaxtempmodel$deviance)#
#McFadden's pseudo R-squared
pRsq<-function(nulldev, residdev) {
pseudoRsq<-1-(residev/nulldev)
pseudoRsq
}
summary(hmaxtempmodel)  #AIC==336158
pRsq(hmaxtempmodel$null.deviance, hmaxtempmodel$deviance)#
pRsq<-function(nulldev, residdev) {
pseudoRsq<-1-(residdev/nulldev)
pseudoRsq
}
summary(hmaxtempmodel)  #AIC==336158
pRsq(hmaxtempmodel$null.deviance, hmaxtempmodel$deviance)#
summary(hmintempmodel) #AIC==373140
pRsq(hmintempmodel$null.deviance, hmintempmodel$deviance)
summary(hmaxhummodel) #AIC==307829
pRsq(hmaxhummodel$null.deviance, hmaxhummodel$deviance)
summary(hminhummodel) #AIC==  304791
pRsq(hminhummodel$null.deviance, hminhummodel$deviance)
#Complete Model (all variants)
hfullmodel<- glm(hatch_total~infected+havminhum+havmaxhum+havmintemp+havmaxtemp,offset(egg_total),data=FFdata, offset(egg_total),family="poisson")
summary(hfullmodel) #AIC==148245
hselectedmodel<-glm(hatch_total~infected+lifespan+havmaxtemp+havminhum, data=FFdata, offset(egg_total),family="poisson")
summary(hselectedmodel)  #AIC==93152   P(infection)==< 2e-16 ***
hAltModelA<-glm(hatch_total~infected+lifespan+havmintemp+havminhum, data=FFdata, offset(egg_total),family="poisson")
summary(hAltModelA) #AIC==93113
hAltModelB<-glm(hatch_total~infected+lifespan+havmaxtemp+havmaxhum, data=FFdata, offset(egg_total),family="poisson")
summary(hAltModelB) #AIC==93261
hAltModelC<-glm(hatch_total~infected+lifespan+havmintemp+havmaxhum, data=FFdata, offset(egg_total),family="poisson")
summary(hAltModelC) #AIC== 93221
hAltModelH<-glm(hatch_total~infected+lifespan+havminhum+havmaxhum, data=FFdata, offset(egg_total),family="poisson")
summary(hAltModelH) #AIC== 92749**
93025
hAltModelI<-glm(hatch_total~infected+lifespan+havmintemp+havmaxtemp, data=FFdata, offset(egg_total),family="poisson")
summary(hAltModelI) #AIC==93025
hAltModelD<-glm(hatch_total~infected+lifespan+havmaxtemp+havmintemp+havminhum, data=FFdata, offset(egg_total),family="poisson")
hAltModelE<-glm(hatch_total~infected+lifespan+havmaxtemp+havmintemp+havmaxhum, data=FFdata, offset(egg_total),family="poisson")
hAltModelF<-glm(hatch_total~infected+lifespan+havmaxtemp+havmaxhum+havminhum, data=FFdata, offset(egg_total),family="poisson")
hAltModelG<-glm(hatch_total~infected+lifespan+havmaxhum+havmintemp+havminhum, data=FFdata, offset(egg_total),family="poisson")
summary(hAltModelD) #AIC==92927
summary(hAltModelE)#AIC==92958
summary(hAltModelF)#AIC==92748***
summary(hAltModelG)#AIC==92749**
hcmaxtempmodel<- glm(hatch_total~infected+lifespan+havmaxtemp, data=FFdata, offset(egg_total),family="poisson")
hcmintempmodel<- glm(hatch_total~infected+lifespan+havmintemp, data=FFdata, offset(egg_total),family="poisson")
hcmaxhummodel<- glm(hatch_total~infected+lifespan+havmaxhum, data=FFdata, offset(egg_total),family="poisson")
hcminhummodel<- glm(hatch_total~infected+lifespan+havminhum, data=FFdata, offset(egg_total),family="poisson")
summary(hcmaxtempmodel)  #AIC==179349
pRsq(hAltModelF$null.deviance, hAltModelF$deviance) #
pRsq(hAltModelF$null.deviance, hAltModelF$deviance) #
pRsq(hAltModelG$null.deviance, hAltModelG$deviance) #
plot(hAltModelG)
?names(FFdataPC)
names(FFdataPC)
names(FFdata)
FFdata$trial<-as.factor(FFdata$trial)
hcminhummodel<- glm(hatch_total~infected+lifespan+havminhum+trial, data=FFdata, offset(egg_total),family="poisson")
trialmod<- glm(hatch_total~infected+lifespan+havminhum+trial, data=FFdata, offset(egg_total),family="poisson")
summary(trialmod)
FFdata$mouseidnum<-as.factor(FFdata$trial)
?FFdata
summary(trialmod)
names(FFdata)
mousemodglm(hatch_total~infected+lifespan+havminhum+mouse, data=FFdata, offset(egg_total),family="poisson")
summary(mousemod)
FFdata$trial<-as.factor(FFdata$trial)
FFdata$mouseidnum<-as.factor(FFdata$trial)
trialmod<- glm(hatch_total~infected+lifespan+havminhum+trial, data=FFdata, offset(egg_total),family="poisson")
summary(trialmod)
mousemod<- glm(hatch_total~infected+lifespan+havminhum+mouse, data=FFdata, offset(egg_total),family="poisson")
summary(mousemod)
mousemod<- glm(hatch_total~infected+lifespan+havminhum+mouseidnum, data=FFdata, offset(egg_total),family="poisson")
summary(mousemod)
summary(trialmod)
othermod<-glm(hatch_total~infected+lifespan+havminhum+trial+mouse+infected*trial, data=FFdata, offset(egg_total),family="poisson")
summary(othermod)
othermod<-glm(hatch_total~infected+lifespan+havminhum+trial+mouseidnum+infected*trial, data=FFdata, offset(egg_total),family="poisson")
summary(othermod)
othermod<-glm(hatch_total~infected+lifespan+havminhum+trial+mouseidnum+infected*trial, data=FFdata, offset(egg_total),family="poisson")
summary(othermod)
othermod<-glm(hatch_total~infected+lifespan+havminhum+trial+infected*trial, data=FFdata, offset(egg_total),family="poisson")
summary(othermod)
trialmod<- glm(hatch_total~infected+lifespan+havminhum+trial, data=FFdata, offset(egg_total),family="poisson")
summary(trialmod)
trialintmod<-glm(hatch_total~infected+lifespan+havminhum+trial+infected*trial, data=FFdata, offset(egg_total),family="poisson")
summary(trialintmod)
pRsq(trialintmod$deviance, trialintmod$null.deviance)
pRsq(trialintmod$null.deviance, trialintmod$deviance)
othermod<-glm(hatch_total~infected+lifespan+havminhum+trial+mouseidnum+infected*trial, data=FFdata, offset(egg_total),family="poisson")
summary(othermod) #AIC==
mousemod<- glm(hatch_total~infected+lifespan+havminhum+mouseidnum, data=FFdata, offset(egg_total),family="poisson")
summary(mousemod) #AIC==
summary(trialmod)
mousemod<- glm(hatch_total~infected+lifespan+havminhum+mouseidnum, data=FFdata, offset(egg_total),family="poisson")
summary(mousemod) #AIC==163793
othermod<-glm(hatch_total~infected+lifespan+havminhum+trial+mouseidnum+infected*trial, data=FFdata, offset(egg_total),family="poisson")
summary(othermod) #AIC==162981
trialintmod<-glm(hatch_total~infected+lifespan+havminhum+trial+infected*trial, data=FFdata, offset(egg_total),family="poisson")
summary(trialintmod) #162981  <- even better than just trial
pRsq(trialintmod$null.deviance, trialintmod$deviance) #0.695
mouseintmod<-glm(hatch_total~infected+lifespan+havminhum+trial+infected*mouse, data=FFdata, offset(egg_total),family="poisson")
summary(trialintmod) #162981  <- even better than just trial
pRsq(trialintmod$null.deviance, trialintmod$deviance) #0.695
summary(mouseintmod) #162981  <- even better than just trial
pRsq(mouseintmod$null.deviance, mouseintmod$deviance) #0.695
mouseintmod<-glm(hatch_total~infected+lifespan+havminhum+trial+infected*mouse, data=FFdata, offset(egg_total),family="poisson")
mouseintmod<-glm(hatch_total~infected+lifespan+havminhum+trial+infected*mouseidnum, data=FFdata, offset(egg_total),family="poisson")
summary(mouseintmod) #162981  <- even better than just trial
pRsq(mouseintmod$null.deviance, mouseintmod$deviance) #0.695
unique(trial)
unique(FFdata$trial)
summary(mouseintmod) #162981
unique(mouseidnum)
mouseintmod<-glm(hatch_total~infected+lifespan+havminhum+trial+infected*mouseidnum, data=FFdata, offset(egg_total),family="poisson")
summary(mouseintmod) #162981
pRsq(mouseintmod$null.deviance, mouseintmod$deviance) #0.695
mousemod<- glm(hatch_total~infected+lifespan+havminhum+mouseidnum, data=FFdata, offset(egg_total),family="poisson")
summary(mousemod) #AIC==163793
trialintmod<-glm(hatch_total~infected+lifespan+havminhum+trial+infected*trial, data=FFdata, offset(egg_total),family="poisson")
summary(trialintmod) #162981  <- even better than just trial
pRsq(trialintmod$null.deviance, trialintmod$deviance) #0.695
#162981
FFdata$mouseidnum<-as.factor(FFdata$trial)#163793  <-so we shoudl include trial
trialmod<- glm(hatch_total~infected+lifespan+havmaxhum+havmintemp+havminhum+trial, data=FFdata, offset(egg_total),family="poisson")
summary(trialmod) #AIC==163793
pRsq(trialmod$null.deviance, trialmod$deviance) #0.695
trialintmod<-glm(hatch_total~infected+lifespan+havmaxhum+havmintemp+havminhum+trial+infected*trial, data=FFdata, offset(egg_total),family="poisson")
summary(trialintmod) #162981  <- even better than just trial
pRsq(trialintmod$null.deviance, trialintmod$deviance) #0.695
trialintmodmxt<-glm(hatch_total~infected+lifespan+havmaxhum+havmintemp+havminhum+havmaxtemp+trial+infected*trial, data=FFdata, offset(egg_total),family="poisson")
summary(trialintmodmxt) #  <- even better than just trial
pRsq(trialintmodmxt$null.deviance, trialintmod$deviance) #
trialintmodmxt<-glm(hatch_total~infected+lifespan+havmaxhum+havmintemp+havminhum+havmaxtemp+trial+infected*trial, data=FFdata, offset(egg_total),family="poisson")
summary(trialintmodmxt) #  <- even better than just trial
pRsq(trialintmodmxt$null.deviance, trialintmod$deviance) #0.7482648
summary(trialintmod) #143768  <- even better than just trial
pRsq(trialintmod$null.deviance, trialintmod$deviance) #0.7482648
pRsq(trialintmodmxt$null.deviance, trialintmod$deviance) #0.7482648
pRsq(trialintmodmxt$null.deviance, trialintmodmxt$deviance) #0.7482648
names(FFdata)
trialintmodmxt<-glm(hatch_total~infected+lifespan+havmaxhum+havmintemp+havminhum+havmaxtemp+trial+infected*trial, data=FFdata, offset(egg_total),family="poisson")
summary(trialintmodmxt) #143768  <-best model thus far
pRsq(trialintmodmxt$null.deviance, trialintmodmxt$deviance) #0.7503481
1.038e-01
exp(0.1038)
completemodel<-glm.nb(hatch_total~infected+lifespan+havmaxhum+havmintemp+havminhum+havmaxtemp+trial+infected*trial, data=FFdata, offset(egg_total))
summary(trialintmodmxt) #  <-best model thus far
pRsq(trialintmodmxt$null.deviance, trialintmodmxt$deviance) #
completemodel<-glm.nb(hatch_total~infected+lifespan+havmaxhum+havmintemp+havminhum+havmaxtemp+trial+infected*trial, data=FFdata, offset(egg_total))
summary(completemodel) #  <-best model thus far
pRsq(completemodel$null.deviance, completemodel$deviance) #
completemodel<-glm.nb(hatch_total~infected+lifespan+avmaxhum+avmintemp+avminhum+avmaxtemp+trial+infected*trial, data=FFdata, offset(egg_total))
summary(completemodel) #91020  <-best model thus far
pRsq(completemodel$null.deviance, completemodel$deviance) #0.6781681
completemodelni<-glm.nb(hatch_total~infected+lifespan+avmaxhum+avmintemp+avminhum+avmaxtemp+trial, data=FFdata, offset(egg_total))
summary(completemodelni) #91904  <-best model thus far
glm.nb(hatch_total~infected+lifespan+avmaxhum+avmintemp+avminhum+avmaxtemp, data=FFdata, offset(egg_total))
summary(glm.nb(hatch_total~infected+lifespan+avmaxhum+avmintemp+avminhum+avmaxtemp, data=FFdata, offset(egg_total))
)
fullmodel<-glm.nb(egg_total~infected+avmaxtemp+avminhum+avmaxhum+avmintemp, data=FFdata, offset(lifespan))
summary(fullmodel) #AIC==26040
glm.nb(egg_total~infected+lifespan+avmaxhum+avmintemp+avminhum+avmaxtemp, data=FFdata, offset(lifespan))
summary(glm.nb(egg_total~infected+lifespan+avmaxhum+avmintemp+avminhum+avmaxtemp, data=FFdata, offset(lifespan)))
glm.nb(egg_total~infected+lifespan+avmaxhum+avmintemp+avminhum+avmaxtemp+trial, data=FFdata, offset(lifespan))
summary(glm.nb(egg_total~infected+lifespan+avmaxhum+avmintemp+avminhum+avmaxtemp+trial, data=FFdata, offset(lifespan)))
glm.nb(egg_total~infected+lifespan+avmintemp+avminhum+avmaxtemp+trial, data=FFdata, offset(lifespan))
summary(glm.nb(egg_total~infected+lifespan+avmintemp+avminhum+avmaxtemp+trial, data=FFdata, offset(lifespan)))
glm.nb(egg_total~infected+lifespan+avmintemp+avminhum+avmaxtemp+trial*infection, data=FFdata, offset(lifespan))
glm.nb(egg_total~infected+lifespan+avmintemp+avminhum+avmaxtemp+trial*infected, data=FFdata, offset(lifespan))
(glm.nb(egg_total~infected+lifespan+avmintemp+avminhum+avmaxtemp+trial*infected, data=FFdata, offset(lifespan)))
summary(glm.nb(egg_total~infected+lifespan+avmintemp+avminhum+avmaxtemp+trial*infected, data=FFdata, offset(lifespan)))
glm.nb(egg_total~infected+lifespan+avmintemp+avminhum+trial*infected, data=FFdata, offset(lifespan))
summary(glm.nb(egg_total~infected+lifespan+avmintemp+avminhum+trial*infected, data=FFdata, offset(lifespan))
)
exp(0.240146)
trialintmod<-glm(hatch_total~infected+lifespan+havmaxhum+havmintemp+havminhum+trial+infected*trial, data=FFdata, offset(egg_total),family="poisson")
summary(trialintmod) #162981  <- even better than just trial
pRsq(trialintmod$null.deviance, trialintmod$deviance) #0.695
#162981
summary(trialintmodmxt) #1437
e
exp(1)
