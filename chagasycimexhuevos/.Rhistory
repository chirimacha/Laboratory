removedeathday<-function(weektab){
deads<-which(table$alive<8)
tablerd<-table[-deads,]
tablerd
}
C8weekRd<-removedeathday(C8week)
which(C8week$aliv<8)
dim(C8week)
length(which(C8week$aliv<8))
153/383
length(which(C8week$alive<8))
length(which(C8week$a<8))
C8week$aliv
names(C8week)
length(which(C8week$alive<8))
removedeathday<-function(weektab){
deads<-which(weektab$alive<8)
tablerd<-weektab[-deads,]
tablerd
}
C8weekRd<-removedeathday(C8week)
C2weekRd<-removedeathday(C2week)
hist(C2weekRd$eggs)
hist(C2weekRd$eggs, breaks=(max(C2weekRD$eggs))
)
C2weekRd
removedeathday<-function(weektab){
deads<-which(weektab$alive<8)
tablerd<-weektab[,-deads]
tablerd
}
removedeathday<-function(weektab){
deads<-which(weektab$alive<8)
tablerd<-weektab[,-deads]
tablerd
}
C2weekRd<-removedeathday(C2week)
C2weekRd
removedeathday<-function(weektab){
deads<-which(weektab$alive<8)
tablerd<-weektab[,-deads]
tablerd
}
C2weekRd<-removedeathday(C2week)
C2weekRd
C2week
removetheday(C2week)
removedeathday(C2week)
which(C2week$alive<a)
which(C2week$alive<8)
removedeathday<-function(weektab){
deads<-which(weektab$alive<max(weektab$alive))
tablerd<-weektab[,-deads]
tablerd
}
C2weekRd<-removedeathday(C2week)
C2weekRD
C2weekRd
hist(C2weekRd$eggs)
C2weekRd<-removedeathday(C3week)
C3weekRd<-removedeathday(C3week)
hist(C3weekRd$eggs)
View(C3weekRd)
glm(eggs~tempmax)
glm(eggs~tempmax, data=Compile)
###Using Cimfert
#solution: use "p" and "v" from substring of names to identify which are postura y viability columns
#be sure to check that no other columns of new data contain these letters at the end.
postura<-which(substr(names(cimfert), nchar(names(cimfert)), nchar(names(cimfert)))=="p")
viabilidad <-which(substr(names(cimfert), nchar(names(cimfert)), nchar(names(cimfert)))=="v")
###Calculating Confidence Intervals
#na's make this difficult
sdcim<-function(dataframe, rowin){
sd(dataframe[,rowin], na.rm=TRUE)
}
findn<-function(dataframe, rowin){
real<-which(is.na(dataframe[,rowin])==FALSE)
length(real)
}
#put these functions into giant looping function for each infection status
colSummary<-function(treatment, dependentvariable){
df<-cimfert[treatment,]
sds<-sapply(X=dependentvariable, sdcim, dataframe=df)
ns<-sapply(X=dependentvariable, findn, dataframe=df)
xbar<-colMeans(df[,dependentvariable], na.rm= TRUE, dims=1)
uCI<-xbar+(1.96*(sds/sqrt(ns)))
lCI<-xbar-(1.96*(sds/sqrt(ns)))
mtxdep <- as.matrix(cimfert[, dependentvariable])
medians <- colMedians(mtxdep[treatment,], na.rm=TRUE)
data.frame(sds, ns, xbar, medians, uCI, lCI)
}
#now assemble tables accordingly
#assemble tables for the eggs laid
totegg<-colSummary(tot, postura)
infegg<-colSummary(infect, postura)
conegg<-colSummary(controls, postura)
cPLegg<-colSummary(ControlP, postura )
iPLegg<-colSummary(InfectP, postura)
cRAegg<-colSummary(ControlRA, postura)
iRAegg<-colSummary(InfectRA, postura)
cRBegg<-colSummary(ControlRB, postura)
iRBegg<-colSummary(InfectRB, postura)
#assemble tables fo the eggs hatched.
totvia<-colSummary(tot, viabilidad)
infvia<-colSummary(infect, viabilidad)
convia<-colSummary(controls, viabilidad)
cPLvia<-colSummary(ControlP, viabilidad)
iPLvia<-colSummary(InfectP, viabilidad)
cRAvia<-colSummary(ControlRA, viabilidad)
iRAvia<-colSummary(InfectRA, viabilidad)
cRBvia<-colSummary(ControlRB, viabilidad)
iRBvia<-colSummary(InfectRB, viabilidad)
#assemble tables for percent viability
###====================================================================================
##We can now plot this data for eggs
#all the repetitions pooled togehter.
par(mfrow=c(1,1))
#pdf(file="graphs/AvgEggsLaidBtwnAlvInfyContRepsCombobyWeek.pdf")
plot(infegg$xbar, type="o", main="Average Eggs Laid Between Alive Infected and Control Insects in all Replicates Combined",
ylab="Number of eggs", xlab="Week in Study", ylim=c(0,8), col="darkorange1", pch=18)
lines(conegg$xbar, type="o", pch=16, col="dodgerblue1")
points(infegg$uCI, col="darkorange1")
points(infegg$lCI, col="darkorange1")
points(conegg$uCI, col="dodgerblue1")
points(conegg$lCI, col="dodgerblue1")
legend("topright", c("infected","controls", "95% CI"), col=c("darkorange1", "dodgerblue1","black"), pch=c(18,16,1))
#dev.off()
#Por Pilot
#pdf(file="graphs/AvgEggsLaidBtwnAlvInfyCntrlPlbyWeek.pdf")
plot(iPLegg$xbar, type="o", main="Average Eggs Laid Between Alive Infected and Control Insects in Pilot",
ylab="Number of eggs", xlab="Week in Study", col="darkorange1", pch=18)
lines(cPLegg$xbar, type="o", pch=16, col="dodgerblue1")
points(iPLegg$uCI, col="darkorange1")
points(iPLegg$lCI, col="darkorange1")
points(cPLegg$uCI, col="dodgerblue1")
points(cPLegg$lCI, col="dodgerblue1")
legend("topright", c("infected","controls", "95% CI"), col=c("darkorange1", "dodgerblue1", "black"),
pch=c(18,16))
#dev.off()
#pdf(file="graphs/AvgEggsLaidBtwnAlvInfyCntrlR1byWeek.pdf")
plot(iRAegg$xbar, type="o", main="Average Eggs Laid Between Alive Infected and Control Insects in Rep 1",
ylab="Number of eggs", xlab="Week in Study", col="darkorange1", pch=18)
lines(cRAegg$xbar, type="o", pch=16, col="dodgerblue1")
points(iRAegg$uCI, col="darkorange1")
points(iRAegg$lCI, col="darkorange1")
points(cRAegg$uCI, col="dodgerblue1")
points(cRAegg$lCI, col="dodgerblue1")
legend("topright", c("infected","controls","95% CI"), col=c("darkorange1", "dodgerblue1", "black"), pch=c(18,16,1))
#dev.off()
Compile$avhum <- as.numeric(Compile$avhum)
plot(Compile$date, Compile$avhum,col="dodgerblue", ylim=c(24,60),
main="Temperature and Humidity", ylab="Relative Humidity(%) and Temperature(C)",
xlab="Date")
points(Compile$date, Compile$avtemp, col="tomato")
legend("topleft", c("Humidity", "Temperature"), text.col=c("dodgerblue","tomato"))
humeggs<-lm(Compile$eggs ~Compile$avhum)
plot(Compile$avhum, Compile$eggs+rnorm(length(Compile$eggs), 0, 0.5),
main="Eggs by Humidity", ylab="Number of Eggs",
xlab="Humidity(%)")
abline(humeggs)
summary(humeggs)
egghum<-ggplot(aes( y= eggs, x= avhum, na.rm=TRUE),
data=Compile[enona,])+geom_point(data=Compile[enona,])
egghum<-egghum+ggtitle("Number of Eggs Laid by Humidity and Infection Status")
egghum<-egghum+facet_grid(. ~infected)+geom_smooth(method= "lm")
egghum
##lets makle a combined plot of the two groups together
enona<-which(is.na(Compile$eggs)==FALSE)
hnona<-which(is.na(Compile$hatch)==FALSE)
Compile$infected<-as.factor(Compile$infected)
Compile$week<-as.factor(Compile$week)
#pdf("graphs/NumEggsLaidByWeekYInfyCntlBox.pdf")
g<-ggplot(aes( y= eggs, x= week, fill = infected, na.rm=TRUE),
data= Compile[enona,]) +geom_boxplot(data=Compile[enona,])
g<-g+ggtitle("Distribution of Number of Eggs Laid by Infection Status")
g
#dev.off()
#eggs laid by humidity
humeggs<-lm(Compile$eggs ~Compile$avhum)
plot(Compile$avhum, Compile$eggs+rnorm(length(Compile$eggs), 0, 0.5),
main="Eggs by Humidity", ylab="Number of Eggs",
xlab="Humidity(%)")
abline(humeggs)
#summary(humeggs)
egghum<-ggplot(aes( y= eggs, x= avhum, na.rm=TRUE),
data=Compile[enona,])+geom_point(data=Compile[enona,])
egghum<-egghum+ggtitle("Number of Eggs Laid by Humidity and Infection Status")
egghum<-egghum+facet_grid(. ~infected)+geom_smooth(method= "lm")
egghum
glm(eggs ~infected*avhum, data=Compile)
eghum<-glm(eggs ~infected*avhum, data=Compile)
eghum
humegg
humeggs
summary(humeggs)
summary(eghum)
plotall<-function(TRIAL)
{
plot(1:30,1:30,col=0)
for(i in unique(d$idnum))
{
sel<-d$idnum==i & d$trial==TRIAL
lines(d$week[sel],d$eggs[sel],col=d$infected[sel]+1)
}
}
egghumavhigh<-ggplot(aes( y= eggs, x= avhumhigh, na.rm=TRUE),
data=Compile[enona,])+geom_point(data=Compile[enona,])
egghumavhigh<-egghumavhigh+ggtitle("Number of Eggs Laid by Max Humidity and Infection Status")
egghumavhigh<-egghumavhigh+facet_grid(. ~infected)+geom_smooth(method= "lm")
egghumavhigh
#eggs by average low hum
egghumavlow<-ggplot(aes( y= eggs, x= avhumlow, na.rm=TRUE),
data=Compile[enona,])+geom_point(data=Compile[enona,])
egghumavlow<-egghumavlow+ggtitle("Number of Eggs Laid by Average Low Humidity and Infection Status")
egghumavlow<-egghumavlow+facet_grid(. ~infected)+geom_smooth(method= "lm")
egghumavlow
#eggs by week max high
egghumhigh<-ggplot(aes( y= eggs, x= hummax, na.rm=TRUE),
data=Compile[enona,])+geom_point(data=Compile[enona,])
egghumhigh<-egghumhigh+ggtitle("Number of Eggs Laid by Max Humidity and Infection Status")
egghumhigh<-egghumhigh+facet_grid(. ~infected)+geom_smooth(method= "lm")
egghumhigh
#eggs by week low high
egghumlow<-ggplot(aes( y= eggs, x= hummin, na.rm=TRUE),
data=Compile[enona,])+geom_point(data=Compile[enona,])
egghumlow<-egghumlow+ggtitle("Number of Eggs Laid by Low Humidity and Infection Status")
egghumlow<-egghumlow+facet_grid(. ~infected)+geom_smooth(method= "lm")
egghumlow
#eggs by hum diff
egghumdiff<-ggplot(aes( y= eggs, x= humdiff, na.rm=TRUE),
data=Compile[enona,])+geom_point(data=Compile[enona,])
egghumdiff<-egghumdiff+ggtitle("Number of Eggs Laid by Largest Humidity Difference and Infection Status")
egghumdiff<-egghumdiff+facet_grid(. ~infected)+geom_smooth(method= "lm")
egghumdiff
#lets compare which of these would be best for the model
mavhum<-glm(eggs~avhum*infected, data=Compile)
mavhumhigh<-glm(eggs~avhumhigh*infected, data=Compile)
mavhumlow<-glm(eggs~avhumlow*infected, data=Compile)
mhummax<-glm(eggs~hummax*infected, data=Compile)
mhummin<-glm(eggs~hummin*infected, data=Compile)
mhumdiff<-glm(eggs~humdiff*infected, data=Compile)
mavhum<-glm(eggs~avhum*infected, data=Compile)
mavhumhigh<-glm(eggs~avhumhigh*infected, data=Compile)
mavhumlow<-glm(eggs~avhumlow*infected, data=Compile)
mhummax<-glm(eggs~hummax*infected, data=Compile)
mhummin<-glm(eggs~hummin*infected, data=Compile)
mhumdiff<-glm(eggs~humdiff*infected, data=Compile)
mhummax
summary(hummax)
summary(mhummax)
lmhummax<-lm(eggs~hummax, data=Compile)
lmhummax
summary(lmhummax)
mavhum
mavhumhigh<-glm(eggs~avhumhigh*infected, data=Compile)
mavhumhigh
mavhumlow
mhummin
mhumdiff
avhhumpdiff<-glm(eggs~avhum*+humdiff, data=Compile)#13910
avhumpdiff
avhhumpdiff
humeggs
avhumlm<-lm(eggs~avhum, data=Compile)
avhumhighlm<-lm(eggs~avhumhigh, data=Compile)
avhumlm
summary(avhumlm)
summary(avhumhighlm)
summary(avhumlowlm)
avhumlm<-lm(eggs~avhum, data=Compile)
avhumlowlm<-lm(eggs~avhumlow, data=Compile)
summary(avhumlowlm)
humminlm<-lm(eggs~hummin, data=Compile)
avhumlowlm<-lm(eggs~avhumlow, data=Compile)
summary(avhumlowlm)
humminlm<-lm(eggs~hummin, data=Compile)
summary(humminlm)
avhumhighlm<-lm(eggs~avhumhigh, data=Compile)
summary(avhumhighlm)
mavtemp<-glm(eggs~avtemp*infected, data=Compile)
mavtemphigh<-glm(eggs~avtemphigh*infected, data=Compile)
mavtemplow<-glm(eggs~avtemplow*infected, data=Compile)
mavmin<-glm(eggs~tempmin*infected, data=Compile)
mtempmax-glm(eggs~tempmax*infected, data=Compile)
mtempdiff-glm(eggs~tempdiff*infected, data=Compile)
mavtemp<-glm(eggs~avtemp*infected, data=Compile)
mavtemphigh<-glm(eggs~avtemphigh*infected, data=Compile)
mavtemplow<-glm(eggs~avtemplow*infected, data=Compile)
mavmin<-glm(eggs~tempmin*infected, data=Compile)
mtempmax<-glm(eggs~tempmax*infected, data=Compile)
mtempdiff<-glm(eggs~tempdiff*infected, data=Compile)
mavtemp
mavtemphigh
mavtemplow
#plot temperature by eggs
Compile$avtemp <- as.character(Compile$avtemp)
tempeggs<-lm(Compile$eggs ~Compile$avtemp)
plot(Compile$avtemp, Compile$eggs,
main="Eggs by Temperature", ylab="Number of Eggs",
xlab="Temperature(C)")
#eggs by average temp
eggtemp<-ggplot(aes( y= eggs, x= avtemp, na.rm=TRUE),
data=Compile[enona,])+geom_point(data=Compile[enona,])
eggtemp<-eggtemp+ggtitle("Number of Eggs Laid by Average Temperature and Infection Status")
eggtemp<-eggtemp+facet_grid(. ~infected)+geom_smooth(method= "lm")
eggtemp
#eggs by average high hum
eggtempavhigh<-ggplot(aes( y= eggs, x= avtemphigh, na.rm=TRUE),
data=Compile[enona,])+geom_point(data=Compile[enona,])
eggtempavhigh<-eggtempavhigh+ggtitle("Number of Eggs Laid by Avg High Temp and Infection Status")
eggtempavhigh<-eggtempavhigh+facet_grid(. ~infected)+geom_smooth(method= "lm")
eggtempavhigh
#eggs by average low hum
eggtempavlow<-ggplot(aes( y= eggs, x= avtemplow, na.rm=TRUE),
data=Compile[enona,])+geom_point(data=Compile[enona,])
eggtempavlow<-eggtempavlow+ggtitle("Number of Eggs Laid by Avg Low Temperature and Infection Status")
eggtempavlow<-eggtempavlow+facet_grid(. ~infected)+geom_smooth(method= "lm")
eggtempavlow
#eggs by week max high
eggtemphigh<-ggplot(aes( y= eggs, x= tempmax, na.rm=TRUE),
data=Compile[enona,])+geom_point(data=Compile[enona,])
eggtemphigh<-eggtemphigh+ggtitle("Number of Eggs Laid by Max Temperature and Infection Status")
eggtemphigh<-eggtemphigh+facet_grid(. ~infected)+geom_smooth(method= "lm")
eggtemphigh
#eggs by week low high
eggtemplow<-ggplot(aes( y= eggs, x= tempmin, na.rm=TRUE),
data=Compile[enona,])+geom_point(data=Compile[enona,])
eggtemplow<-egghumlow+ggtitle("Number of Eggs Laid by Low Temperature and Infection Status")
eggtemplow<-egghumlow+facet_grid(. ~infected)+geom_smooth(method= "lm")
eggtemplow
#eggs by temp diff
eggtempdiff<-ggplot(aes( y= eggs, x= tempdiff, na.rm=TRUE),
data=Compile[enona,])+geom_point(data=Compile[enona,])
eggtempdiff<-eggtempdiff+ggtitle("Number of Eggs Laid by Largest Temperature Difference and Infection Status")
eggtempdiff<-eggtempdiff+facet_grid(. ~infected)+geom_smooth(method= "lm")
eggtempdiff
Compile$avtemp <- as.numeric(Compile$avtemp)
eggtem<-ggplot(aes( y= eggs, x= avtemp, na.rm=TRUE),
data=Compile[enona,])+geom_point(data=Compile[enona,])
eggtem<-eggtem+ggtitle("Number of Eggs Laid by Temperature and Infection Status")
eggtem<-eggtem+facet_grid(. ~infected)+geom_smooth(method= "lm")
eggtem
lmavtemp<-lm(eggs~avtemp, data=Compile) #AIC=13900
lmavtemphigh<-lm(eggs~avtemphigh, data=Compile)#AIC=13900
lmavtemplow<-lm(eggs~avtemplow, data=Compile)#AIC=13920
lmavmin<-lm(eggs~tempmin, data=Compile)
lmtempmax<-lm(eggs~tempmax, data=Compile)
lmtempdiff<-lm(eggs~tempdiff, data=Compile)
lmavtemp<-lm(eggs~avtemp, data=Compile)
lmavtemphigh<-lm(eggs~avtemphigh, data=Compile)
lmavtemplow<-lm(eggs~avtemplow, data=Compile)
lmavmin<-lm(eggs~tempmin, data=Compile)
lmtempmax<-lm(eggs~tempmax, data=Compile)
lmtempdiff<-lm(eggs~tempdiff, data=Compile)
summary(lmavtemp)
summary(lmavtemphigh)
summary(lmavtemplow)
summary(lmtempmin)
summary(lmavmin)
summary(lmdiff)
summary(lmtempdiff)
pdf("graphs/NumEggsLaidByWeekYInfyCntlBox.pdf")
g<-ggplot(aes( y= eggs, x= week, fill = infected, na.rm=TRUE),
data= Compile[enona,]) +geom_boxplot(data=Compile[enona,])
g<-g+ggtitle("Distribution of Number of Eggs Laid by Infection Status Each Week")
g
dev.off()
#pdf("graphs/NumEggsHtchByWeekyInfyCntrlBox.pdf")
h<-ggplot(aes( y= hatch, x= week, fill = infected, na.rm=TRUE),
data= Compile[hnona,])+geom_boxplot(data=Compile[hnona,])
h<-h+ggtitle("Distribution of Number of Eggs Hatched by Infection Status")
h
#the box plot for eggs laid
#pdf("graphs/NumEggsLaidByWeekYInfyCntlBox.pdf")
g<-ggplot(aes( y= eggs, x= week, fill = infected, na.rm=TRUE),
data= Compile[enona,]) +geom_boxplot(data=Compile[enona,])
g<-g+ggtitle("Distribution of Number of Eggs Laid by Infection Status Each Week")
g
#dev.off()
par(mfrow=c(1,1))
#pdf(file="graphs/AvgEggsLaidBtwnAlvInfyContRepsCombobyWeek.pdf")
plot(infegg$xbar, type="o", main="Average Eggs Laid Between Alive Infected and Control Insects in all Replicates Combined",
ylab="Number of eggs", xlab="Week in Study", ylim=c(0,8), col="darkorange1", pch=18)
lines(conegg$xbar, type="o", pch=16, col="dodgerblue1")
points(infegg$uCI, col="darkorange1")
points(infegg$lCI, col="darkorange1")
points(conegg$uCI, col="dodgerblue1")
points(conegg$lCI, col="dodgerblue1")
legend("topright", c("infected","controls", "95% CI"), col=c("darkorange1", "dodgerblue1","black"), pch=c(18,16,1))
#dev.off()
plot(iPLegg$xbar, type="o", main="Average Eggs Laid Between Alive Infected and Control Insects in Pilot",
ylab="Number of eggs", xlab="Week in Study", col="darkorange1", pch=18)
lines(cPLegg$xbar, type="o", pch=16, col="dodgerblue1")
points(iPLegg$uCI, col="darkorange1")
points(iPLegg$lCI, col="darkorange1")
points(cPLegg$uCI, col="dodgerblue1")
points(cPLegg$lCI, col="dodgerblue1")
legend("topright", c("infected","controls", "95% CI"), col=c("darkorange1", "dodgerblue1", "black"),
pch=c(18,16))
#dev.off()
#pdf(file="graphs/AvgEggsLaidBtwnAlvInfyCntrlR1byWeek.pdf")
plot(iRAegg$xbar, type="o", main="Average Eggs Laid Between Alive Infected and Control Insects in Rep 1",
ylab="Number of eggs", xlab="Week in Study", col="darkorange1", pch=18)
lines(cRAegg$xbar, type="o", pch=16, col="dodgerblue1")
points(iRAegg$uCI, col="darkorange1")
points(iRAegg$lCI, col="darkorange1")
points(cRAegg$uCI, col="dodgerblue1")
points(cRAegg$lCI, col="dodgerblue1")
legend("topright", c("infected","controls","95% CI"), col=c("darkorange1", "dodgerblue1", "black"), pch=c(18,16,1))
#dev.off()
plot(iPLegg$xbar, type="o", main="Average Eggs Laid Alive Between Infected and Control Insects",
ylab="Number of eggs", xlab="Week in Study", col=2, pch=18, lty=1, ylim=c(0,10))
lines(cPLegg$xbar, type="o", pch=1, col=4, lty=1)
lines(iRAegg$xbar, type="o", pch=2, col=2, lty=2)
lines(cRAegg$xbar, type="o", pch=2, col=4, lty=2)
lines(iRBegg$xbar, type="o", pch=3, col=2, lty=3)
lines(cRBegg$xbar, type="o", pch=3, col=4, lty=3)
legend("topright", c("Pilot Infected","Pilot Controls", "Rep1 Infected",
"Rep1 Controls", "Rep2 Infected", "Rep2 Controls"),
col=c(2,4,2,4,2,4), pch=c(1,1,2,2,3,3), lty=c(1,1,2,2,3,3))
#dev.off()
pdf(file="graphs/AllRepsAvgEggLaidbtwnAlvbtwnInfContbyWeek.pdf")
plot(iPLegg$xbar, type="o", main="Average Eggs Laid Alive Between Infected and Control Insects",
ylab="Number of eggs", xlab="Week in Study", col=2, pch=18, lty=1, ylim=c(0,10))
lines(cPLegg$xbar, type="o", pch=1, col=4, lty=1)
lines(iRAegg$xbar, type="o", pch=2, col=2, lty=2)
lines(cRAegg$xbar, type="o", pch=2, col=4, lty=2)
lines(iRBegg$xbar, type="o", pch=3, col=2, lty=3)
lines(cRBegg$xbar, type="o", pch=3, col=4, lty=3)
legend("topright", c("Pilot Infected","Pilot Controls", "Rep1 Infected",
"Rep1 Controls", "Rep2 Infected", "Rep2 Controls"),
col=c(2,4,2,4,2,4), pch=c(1,1,2,2,3,3), lty=c(1,1,2,2,3,3))
dev.off()
#pdf(file="graphs/AllRepsAvgEggLaidbtwnAlvbtwnInfContbyWeek.pdf")
plot(iPLegg$xbar, type="o", main="Average Eggs Laid Amoung Alive Insects by Infection Status",
ylab="Number of eggs", xlab="Week in Study", col=2, pch=18, lty=1, ylim=c(0,10))
lines(cPLegg$xbar, type="o", pch=1, col=4, lty=1)
lines(iRAegg$xbar, type="o", pch=2, col=2, lty=2)
lines(cRAegg$xbar, type="o", pch=2, col=4, lty=2)
lines(iRBegg$xbar, type="o", pch=3, col=2, lty=3)
lines(cRBegg$xbar, type="o", pch=3, col=4, lty=3)
legend("topright", c("Pilot Infected","Pilot Controls", "Rep1 Infected",
"Rep1 Controls", "Rep2 Infected", "Rep2 Controls"),
col=c(2,4,2,4,2,4), pch=c(1,1,2,2,3,3), lty=c(1,1,2,2,3,3))
#dev.off()
pdf(file="graphs/AllRepsAvgEggLaidbtwnAlvbtwnInfContbyWeek.pdf")
plot(iPLegg$xbar, type="o", main="Average Eggs Laid Amoung Alive Insects by Infection Status",
ylab="Number of eggs", xlab="Week in Study", col=2, pch=18, lty=1, ylim=c(0,10))
lines(cPLegg$xbar, type="o", pch=1, col=4, lty=1)
lines(iRAegg$xbar, type="o", pch=2, col=2, lty=2)
lines(cRAegg$xbar, type="o", pch=2, col=4, lty=2)
lines(iRBegg$xbar, type="o", pch=3, col=2, lty=3)
lines(cRBegg$xbar, type="o", pch=3, col=4, lty=3)
legend("topright", c("Pilot Infected","Pilot Controls", "Rep1 Infected",
"Rep1 Controls", "Rep2 Infected", "Rep2 Controls"),
col=c(2,4,2,4,2,4), pch=c(1,1,2,2,3,3), lty=c(1,1,2,2,3,3))
dev.off()
eggweek<-lm(Compile$eggs ~Compile$week)
hatchweek<-lm(Compile$hatch ~Compile$week)
plot(Compile$week, Compile$eggs+rnorm(length(Compile$eggs), 0, 0.5), main="Eggs by Week")
abline(eggweek)
boxplot(Compile$eggs ~Compile$week, main="Eggs by Week")
plot(Compile$week, Compile$hatch+rnorm(length(Compile$hatch), 0, 0.5), main="Hatching by Week")
abline(hatchweek)
boxplot(Compile$hatch ~Compile$week, main="Hatching by Week")
plot(peraltotweek, col="black", xlab="Proportion Alive", ylab="Week",
main="Proportion Alive in Infected and Controls by Week")
points(peralconweek, col="steelblue")
points(peralinfweek, col="red")
legend("topright", c("All Bugs","infected","controls"),
col=c("black","red", "steelblue"), pch=c(1,1,1))
#dev.off()
)
#Other parts of this study show that life span changes depending on inf
#lets look at the number alive by week
alivetotweek <- c(1:length(unique(Compile$week))*NA)
aliveinfweek <- c(1:length(unique(Compile$week))*NA)
aliveconweek <- c(1:length(unique(Compile$week))*NA)
infected <- which(Compile$infected==1)
controlled <- which(Compile$infected==0)
#loop counts the number alive in each week (total, infected, and controls)
for (i in 1:length(unique(Compile$week))){
week<-which(Compile$week==i)
alivetotweek[i]<-sum(Compile$alive[week])
inf<-intersect(week, infected)
con<-intersect(week, controlled)
aliveinfweek[i]<-sum(Compile$alive[inf])
aliveconweek[i]<-sum(Compile$alive[con])
}
#pdf("graphs/NumInctsAlvByWeek.pdf")
plot(alivetotweek)
points(aliveinfweek, col="red")
points(aliveconweek, col="steelblue")
legend("topright", c("All Bugs","infected","controls"),
col=c("black","red", "steelblue"), pch=c(1,1,1))
#dev.off()
#a quick check seeing if alivetotweek is the sum of the other two.
#test<-aliveinfweek+aliveconweek
#testing<-data.frame(test, alivetotweek, aliveinfweek, aliveconweek)
#lets get a better view by looking at (percents)
which(cimfert$infected==1)
peraltotweek<-alivetotweek/(length(cimfert$ID))
peralinfweek <-aliveinfweek/(length(which(cimfert$infected==1)))
peralconweek <-aliveconweek/(length(which(cimfert$infected==0)))
#pdf("graphs/PerAlvInsctsByWeek.pdf")
plot(peraltotweek, col="black", xlab="Proportion Alive", ylab="Week",
main="Proportion Alive in Infected and Controls by Week")
points(peralconweek, col="steelblue")
points(peralinfweek, col="red")
legend("topright", c("All Bugs","infected","controls"),
col=c("black","red", "steelblue"), pch=c(1,1,1))
#dev.off()
