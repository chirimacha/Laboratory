a <- available.packages()
head(rownames(a), 3)
install.packages("slidify")
install.packages(c("ggplot2", "devtools"))
install.packages("slidify")
source("http://bioconductor.org/bioLite.R")
biocLite()
library(ggplot2)
search()
"2015-03-23"+30
a<-as.Date("2015-03-23")
a+40
+90
a+90
a+100
-7
a+93
x<-c(0,1,2,NA, FALSE)
x
is.na(x[3])
requiredPackages <- c("XML"
,"doParallel", "lubridate","PBSmapping","plyr","inline","Rcpp"
)
packages <- requiredPackages[!(requiredPackages %in% rownames(installed.packages()))]
if(length(packages) > 0) {
install.packages(packages)
}
fa<-1100+200+26150+2000+2865
fa
2*32315
fees<-((1958+370+168+250)*2)+150
fees
fees+health+rent
fees<-((1958+370+168+250)*2)+150
health<-1570*2
rent<-4326*2
fees+health+rent
tuition(21088*2)
fa<-(1100+200+26150+2000+2865)*2
fa
*
tuition<-(21088*2)
fees<-((1958+370+168+250)*2)+150
health<-1570*2
rent<-4326*2
expense<-fees+health+rent
expenses
expense
expense+tuition
y<-expense+tuition
fa-y
tuition
health+fees
fees
?binom.test
bisampsize<-function(m){
((1.96/m)^2)*0.25
}
bisampsize(0.5)
bisampsize<-function(m){
((1.96/m)^2)*0.25
}
bisampsize(0.25)
bisampsize<-function(m){
((1.96/m)^2)*0.25
}
bisampsize(0.20)
1/12
3/12
binom.power
library(binom)
install.packages(binom)
install.packages("binom")
version
x4 <- sample(1:10, 5, replace=T)
x4
tray1<-sample(1:4, 4)
tray1`
r
)
q
;
''
'
""
)
asdf
104r
+
)
""
'
''
''
sample(1:4, 4)
sample(1:4, 4)
tray1<-
sample(1:4,4)
tray2<-sample(1:4,4)
tray3<-sample(1:4,4)
tray4<-sample(1:4,4)
tray1
tray2
tray3
tray4
quiz<-81.5*15
mid<-84*30
quiz+mid
quiz<-81.5*.15
mid<-84*.30
quiz+mid
100-37.4
quiz<-81.5*.15
mid<-84*.25
hw1<-6*.1
quiz+mid+hw1
.8*50
rnorm(4,4)
sample(1:4,4)
sample(1:4,4)
sample(1:4,4)
sample(1:4,4)
#call the packages
library(lubridate) #para extracting dates
library(reshape2) #para make the wide data into long data
library(matrixStats)
library(ggplot2)
library(plyr)  #para rbind.fill function
library(geeM)
library(MASS)
library(lmtest)
library(pscl)
library(survival)
library(doBy)
library(missMDA)
library(Rmisc) #summarySE command
library(lme4)#linear mixed effects
library(nlme)
# #set directory and bring in files to be analyzed.
# #PC
setwd("c:\\Users\\tradylan\\Documents\\Laboratory\\chagasycimexhuevos")
# #Model with infection and lifespan as covariates.
lifespanmod<-glm.nb(egg_total~infected+lifespan, data=FFdataPC )
summary(lifespanmod )
#AIC==1636.7 P(infected)==0.107
#Null Model without any temperature or humidity variables.
nullmodel<- glm.nb(egg_total~infected, data=FFdataPC, offset(log(lifespan)))
summary(nullmodel)  #AIC==26710   P=<2e-16 *** Theta is 1.13
#Check if poisson would be better
poissonmod<-glm(egg_total~infected, offset(log(lifespan)), data=FFdataPC, family="poisson")
#test from http://www.ats.ucla.edu/stat/r/dae/nbreg.htm
X2 <- 2*(logLik(nullmodel)-logLik(poissonmod))
pchisq(X2, df=1, lower.tail=FALSE)  #is the df=1 because they are the same, except for theta?
lrtest(poissonmod, nullmodel) #this does the same thing, again shows that nb is better
#This rules out poisson
#check for 0 inflation
nullzmod<- zeroinfl(egg_total~infected+offset(log(lifespan)), data=FFdataPC)
vuong(nullmodel, nullzmod) #null model is better, so no zero inflation
FFdataPC <- read.csv("FertilityFecundityDataPC.csv")
lifespanmod<-glm.nb(egg_total~infected+lifespan, data=FFdataPC )
summary(lifespanmod )
#AIC==1636.7 P(infected)==0.107
#Null Model without any temperature or humidity variables.
nullmodel<- glm.nb(egg_total~infected, data=FFdataPC, offset(log(lifespan)))
summary(nullmodel)  #AIC==26710   P=<2e-16 *** Theta is 1.13
#Check if poisson would be better
poissonmod<-glm(egg_total~infected, offset(log(lifespan)), data=FFdataPC, family="poisson")
#test from http://www.ats.ucla.edu/stat/r/dae/nbreg.htm
X2 <- 2*(logLik(nullmodel)-logLik(poissonmod))
pchisq(X2, df=1, lower.tail=FALSE)  #is the df=1 because they are the same, except for theta?
lrtest(poissonmod, nullmodel) #this does the same thing, again shows that nb is better
#This rules out poisson
#check for 0 inflation
nullzmod<- zeroinfl(egg_total~infected+offset(log(lifespan)), data=FFdataPC)
vuong(nullmodel, nullzmod) #null model is better, so no zero inflation
nullmodel<- glm.nb(egg_total~infected, data=FFdataPC, offset(log(lifespan)))
summary(nullmodel) #Theta is 1.13
fullmodel<-glm.nb(egg_total~infected+avmaxtemp+avminhum+avmaxhum+avmintemp, data=FFdataPC, offset(lifespan))
summary(fullmodel) #AIC==
fullmodel<-glm.nb(egg_total~infected+avmaxtemp+avminhum+avmaxhum+avmintemp, data=FFdataPC, offset(log(lifespan)))
summary(fullmodel) #AIC==26040
AltModelA<-glm.nb(egg_total~infected+avmintemp+avminhum, data=FFdataPC, offset(log(lifespan)))
summary(AltModelA) #AIC==
AltModelB<-glm.nb(egg_total~infected+avmaxtemp+avmaxhum, data=FFdataPC, offset(log(lifespan)))
summary(AltModelB) #AIC==
AltModelC<-glm.nb(egg_total~infected+avmintemp+avmaxhum, data=FFdataPC, offset(log(lifespan)))
summary(AltModelC) #AIC==
AltModelD<-glm.nb(egg_total~infected+avminhum+avmaxhum, data=FFdataPC, offset(log(lifespan)))
summary(AltModelD) #AIC==
AltModelE<-glm.nb(egg_total~infected+avmintemp+avmaxtemp, data=FFdataPC, offset(log(lifespan)))
summary(AltModelE) #AIC==
AltModelF<-glm.nb(egg_total~infected+avmaxtemp+avminhum, data=FFdataPC, offset(log(lifespan)))
summary(selectedmodel)
AltModelF<-glm.nb(egg_total~infected+avmaxtemp+avminhum, data=FFdataPC, offset(log(lifespan)))
summary(AltModelF)
pceggmod0 <- glm.nb(egg_total~infected, data=FFdataPC, offset(log(lifespan)))
#Model with 1 PC
pceggmod1 <- glm.nb(egg_total~infected+PC1, data=FFdataPC,
offset(log(lifespan)))
#Model with 2 PC
pceggmod2 <- glm.nb(egg_total~infected+PC1+PC2, data=FFdataPC,
offset(log(lifespan)))
#Model with 2PC and trial
pceggmod2b <- glm.nb(egg_total~infected+PC1+PC2+factor(trial), data=FFdataPC,
offset(log(lifespan)))
#Model with trial and PC2 interaction
pceggmod2c <- glm.nb(egg_total~infected+PC1+PC2*factor(trial), data=FFdataPC,
offset(log(lifespan)))
#Model with trial and PC1 Interaction
pceggmod2d <- glm.nb(egg_total~infected+PC2+PC1*factor(trial), data=FFdataPC,
offset(log(lifespan)))
#Model with trial interacting with both PC2 and PC1
pceggmod2e <- glm.nb(egg_total~infected+PC1*factor(trial)+PC2*factor(trial),
data=FFdataPC, offset(log(lifespan)))
#Model with 3 PC
pceggmod3 <- glm.nb(egg_total~infected+PC1+PC2+PC3, data=FFdataPC,
offset(log(lifespan)))
#Model without PC2 (more significant that 1,2, and 3 if no trial interactions)
pceggmod3b <- glm.nb(egg_total~infected+PC1+PC3, data=FFdataPC,
offset(log(lifespan)))
pceggmod3c <- glm.nb(egg_total~infected+PC1+PC2+PC3+factor(trial),
data=FFdataPC, offset(log(lifespan)))
pceggmod3d <- glm.nb(egg_total~infected+PC1+PC3+factor(trial), data=FFdataPC,
offset(log(lifespan)))
#Full Model with all Principle Components #do not use, may overfit
pceggmod4 <- glm.nb(egg_total~infected+PC1+PC2+PC3+PC4, data=FFdataPC,
offset(log(lifespan)))
pceggmod0#4327
lrtest(pceggmod2d,pceggmod1e)
lrtest(pceggmod2d,pceggmod2e)
FFdataPC$idnum <- as.factor(FFdataPC$idnum)
meeggmod2a <- glmer.nb(egg_total~infected+PC1+PC2+(1|trial)+offset(log(FFdataPC$lifespan)), data=FFdataPC)
meeggmod2b <- glmer.nb(egg_total~infected+PC1+(1|trial)+offset(log(FFdataPC$lifespan)), data=FFdataPC)
meeggmod2c <- glmer.nb(egg_total~infected+PC2+(1|trial)+offset(log(FFdataPC$lifespan)), data=FFdataPC)
meeggmod2a <- glmer.nb(egg_total~infected+PC1+PC2+(1|mouse)+offset(log(FFdataPC$lifespan)), data=FFdataPC)
meeggmod2a <- glmer.nb(egg_total~infected+PC1+PC2+(1|mouseidnum)+offset(log(FFdataPC$lifespan)), data=FFdataPC)
#Only
meeggmodt1_2 <- glmer.nb(egg_total~infected+PC1+PC2+(1|trial)+offset(log(FFdataPC$lifespan)), data=FFdataPC)
meeggmodt1 <- glmer.nb(egg_total~infected+PC1+(1|trial)+offset(log(FFdataPC$lifespan)), data=FFdataPC)
meeggmodt2 <- glmer.nb(egg_total~infected+PC2+(1|trial)+offset(log(FFdataPC$lifespan)), data=FFdataPC)
#With Random Effect on Mouse
meeggmodm1_2 <- glmer.nb(egg_total~infected+PC1+PC2+(1|mouseidnum)+offset(log(FFdataPC$lifespan)), data=FFdataPC)
meeggmodm1 <- glmer.nb(egg_total~infected+PC1+(1|mouseidnum)+offset(log(FFdataPC$lifespan)), data=FFdataPC)
meeggmodm2 <- glmer.nb(egg_total~infected+PC2+(1|mouseidnum)+offset(log(FFdataPC$lifespan)), data=FFdataPC)
hselectedmodel<-glm(hatch_total~infected+lifespan+havmaxtemp+havminhum, data=FFdataPC, offset(egg_total),family="poisson")
summary(hselectedmodel)  #AIC==173490   P(infection)==< 2e-16 ***
hselectedmodelnb<-glm.nb(hatch_total~infected+lifespan+havmaxtemp+havminhum, data=FFdataPC, offset(egg_total))
hselectedmodelnb<-glm.nb(hatch_total~infected+lifespan+havmaxtemp+havminhum, data=FFdataPC, offset(egg_total))
summary(hselectedmodelnb)
hselectedmodelnbhc1<-glm.nb(hatch_total~infected+lifespan+H.Comp1, data=FFdataPC, offset(egg_total))
summary(hselectedmodelnbhc1)
pchatchmodnull<-glm.nb(hatch_total~offset(log(egg_total)), data=FFnonaPC)
pcnona<-which(FFdataPC$egg_total==0)
FFnonaPC<-FFdataPC[-pcnona,]
#Null model with no predictors
pchatchmodnull<-glm.nb(hatch_total~offset(log(egg_total)), data=FFnonaPC)
summary(pchatchmodnull)
pchatchmod1<-glm.nb(hatch_total~infected+HComp.1+offset(log(egg_total)),
data=FFnonaPC)
summary(pchatchmod1)
pchatchmod1<-glm.nb(hatch_total~infected+HComp.1+offset(log(egg_total)),
data=FFdataPC)
summary(pchatchmod1)
pnullhmodel<- glm(hatch_total~infected, data=FFnonaPC, offset(log(egg_total)),family="poisson")
summary(pnullmodel)
summary(pnullhmodel)
nbnullhmodel<-glm.nb(hatch_total~infected, data=FFnonaPC, offset(log(egg_total)))
lrtest(pnullhmodel, nbnullhmodel)
playzero <- zeroinfl(hatch_total~infected +offset(log(egg_total)), data=FFnonaPC, dist="negbin" )
vuong(playzero, nbnullhmodel)  #significantly positive, implies zero inflation is better
nullhmodelB<- glm(hatch_total~infected+lifespan, data=FFnonaPC, offset(log(egg_total)),family="poisson")
summary(nullhmodelB)
nbnullhmodel<-glm.nb(hatch_total~infected, data=FFnonaPC, offset(log(egg_total)))
summary(nbnullhmodel)
nullhmodelB
nbnullhmodel
hselectedmodelnb<-glm.nb( hatch_total~infected+lifespan+havmaxtemp+havminhum, data=FFdataPC, offset(log(egg_total))
summary(hselectedmodelnb )
hfullmodel<- glm(hatch_total~infected+havminhum+havmaxhum+havmintemp+havmaxtemp,offset(log(egg_total)),data=FFdataPC, family="poisson")
summary(hfullmodel ) #AIC==175426
hselectedmodel<-glm(hatch_total~infected+lifespan+havmaxtemp+havminhum, data=FFdataPC, offset(log(egg_total)),family="poisson")
summary(hselectedmodel
)
hselectedmodelnb<-glm.nb(hatch_total~infected+lifespan+havmaxtemp+havminhum, data=FFdataPC, offset(log(egg_total)))
summary(hselectedmodelnb)
hfullmodel<- glm(hatch_total~infected+havminhum+havmaxhum+havmintemp+havmaxtemp,offset(log(egg_total)),data=FFdataPC, family="poisson")
summary(hfullmodel ) #AIC==14469
hfullmodnb<-glm.nb(hatch_total~infected+lifespan+havminhum+havmaxhum+havmintemp+havmaxtemp, data=FFdataPC, offset(log(egg_total)))
summary(hselectedmodelnb) #AIC=5231.9
summary(hfullmodnb) #AIC=5231.9
pchatchmod1<-glm.nb(hatch_total~infected+HComp.1+offset(log(egg_total)),
data=FFnonaPC)
summary(pchatchmod1)
#With ONe PC
pchatchmod1<-glm.nb(hatch_total~infected+HComp.1,offset(log(egg_total)),
data=FFnonaPC)
pchatchmod1b<-glm.nb(hatch_total~infected+HComp.1+lifespan, offset(log(egg_total)),
data=FFnonaPC)
pchatchmod1b
pchatchmod1
pchatchmod1bnb<-glm.nb(hatch_total~infected+HComp.1+lifespan, offset(log(egg_total)),
data=FFnonaPC) #lifespan signifcant decreases AIC
summary(pchatchmod1b)
summary(pchatchmod1)
pchatchmod1nb<-glm.nb(hatch_total~infected,offset(log(egg_total)),
data=FFnonaPC)
pchatchmod1bnb<-glm.nb(hatch_total~infected+lifespan, offset(log(egg_total)),
data=FFnonaPC)
summary(pchatchmod1)
summary(pchatchmod1)
#Alternative models with one of each temperature and humidty value.
hAltModelA<-glm.nb(hatch_total~infected+lifespan+havmintemp+havminhum, data=FFdataPC, offset(log(egg_total)))
summary(hAltModelA) #AIC==
hAltModelA<-glm.nb(hatch_total~infected+lifespan+havmintemp+havminhum, data=FFnonaPC, offset(log(egg_total)))
summary(hAltModelA) #AIC==
hfullmodnb<-glm.nb(hatch_total~infected+lifespan+havminhum+havmaxhum+havmintemp+havmaxtemp, data=FFdataPC, offset(log(egg_total)))
summary(hfullmodnb) #AIC=
hfullmodnb<-glm.nb(hatch_total~infected, data=FFdataPC, offset(log(egg_total)))
summary(hfullmodnb) #AIC=
hfullmodnb<-glm.nb(hatch_total~infected, data=FFdataPC, offset(log(egg_total)))
summary(hfullmodnb) #AIC=
hfullmodnb<-glm.nb(hatch_total~infected, data=FFnonaPC, offset(log(egg_total)))
#Withonly infected
hfullmodnb<-glm.nb(hatch_total~infected, data=FFnonaPC, offset(log(egg_total)))
summary(hfullmodnb) #AIC=
hfullmodnb<-glm.nb(hatch_total~infected, data=FFnonaPC, offset(log(egg_total)))
summary(hfullmodnb) #AIC=
summary(hAltModelA) #AIC==
pcnona<-which(FFdataPC$egg_total==0)
FFnonaPC<-FFdataPC[-pcnona,]
hfullmodnb<-glm.nb(hatch_total~infected+lifespan+havminhum+havmaxhum+havmintemp+havmaxtemp, data=FFdataPC, offset(log(egg_total)))
summary(hfullmodnb) #AIC=5224.1
#Complete Negative Binomial
hfullmodnb<-glm.nb(hatch_total~infected+lifespan+havminhum+havmaxhum+havmintemp+havmaxtemp, data=FFdataPC, offset(log(egg_total)))
summary(hfullmodnb) #AIC=5224.1
hfullmodnb<-glm.nb(hatch_total~infected+lifespan+havminhum+havmaxhum+havmintemp+havmaxtemp, data=FFnonaPC, offset(log(egg_total)))
summary(hfullmodnb) #AIC=5224.1
hfullmodnb<-glm.nb(hatch_total~infected, data=FFnonaPC, offset(log(egg_total)))
summary(hfullmodnb) #AIC=
hAltModelAnb<-glm.nb(hatch_total~infected+lifespan+havmintemp+havminhum, data=FFdataPC, offset(log(egg_total)))
FFdataPC$egg_total
FFdataPC$infected
FFdataPC$lifespan
pchatchmod2d<-glm.nb(hatch_total~infected+lifespan+HComp.1+HComp.2+factor(trial)+
offset(log(egg_total)), data=FFnonaPC)
summary(pchatchmod2d)
pchatchmodnull<-glm.nb(hatch_total~offset(log(egg_total)), data=FFnonaPC)
summary(pchatchmodnull)
pchatchmod0a<-glm.nb(hatch_total~infected+offset(log(egg_total)), data=FFnonaPC)
summary(pchatchmod0a)
pchatchmod0a<-glm.nb(hatch_total~infected, offset(log(egg_total)), data=FFnonaPC)
summary(pchatchmod0a)
?glm.nb
#Model with trial interacting with both PC2 and PC1
pceggmod2e <- glm.nb(egg_total~infected+PC1*factor(trial)+PC2*factor(trial),
data=FFdataPC, offset(log(lifespan)))
summary(pceggmod2e)
pceggmod2e <- glm(egg_total~infected+PC1*factor(trial)+PC2*factor(trial),
data=FFdataPC, offset(log(lifespan)), family="poisson")
pceggmod2e <- glm.nb(egg_total~infected+PC1*factor(trial)+PC2*factor(trial),
data=FFdataPC, offset(log(lifespan)))
pceggmod2epoi <- glm(egg_total~infected+PC1*factor(trial)+PC2*factor(trial),
data=FFdataPC, offset(log(lifespan)), family="poisson")
summary(pceggmod2d)
summary(pceggmod2e)
summary(pceggmod2epoi)
