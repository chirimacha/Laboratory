col=c("darkorange1", "dodgerblue1","black"), pch=c(18,16,1))
#dev.off()
#Por Pilot
#pdf(files="graphs/AvgHtchBtwnAlvInfyCntrlbyWeekPL.pdf")
plot(iPLvia$xbar, type="o", main="Average Hatched Eggs Between Alive Infected and Control Insects in Pilot",
ylab="Number of Hatched Insects", xlab="Week in Study", col="darkorange1", pch=18, ylim=c(0,8))
lines(cPLvia$xbar, type="o", pch=16, col="dodgerblue1")
points(iPLvia$uCI, col="darkorange1")
points(iPLvia$lCI, col="darkorange1")
points(cPLvia$uCI, col="dodgerblue1")
points(cPLvia$lCI, col="dodgerblue1")
legend("topright", c("infected","controls","95% CI"), col=c("darkorange1", "dodgerblue1", "black"), pch=c(18,16,1))
#dev.off()
#Por Rep1
#pdf(files="graphs/R1AvgHtchBtwn.pdf")
plot(iRAvia$xbar, type="o", main="Average Hatched Eggs Between Alive Infected and Control Insects in Rep 1",
ylab="Number of Hatched Insects", xlab="Week in Study", col="darkorange1", pch=18, ylim=c(0,9))
lines(cRAvia$xbar, type="o", pch=16, col="dodgerblue1")
legend("topright", c("infected","controls"), col=c("darkorange1", "dodgerblue1"), pch=c(18,16))
#dev.off()
#Por Rep2
#pdf(files="graphs/R2AvgHtchBtwnAlvInfCntrl.pdf")
plot(iRBvia$xbar, type="o", main="Average Hatched Eggs Between Alive Infected and Control Insects in Rep 2",
ylab="Number of Hatched Insects", xlab="Week in Study", col="darkorange1", pch=18, ylim=c(0,9))
lines(cRBvia$xbar, type="o", pch=16, col="dodgerblue1")
legend("topright", c("infected","controls"), col=c("darkorange1", "dodgerblue1"), pch=c(18,16))
#dev.off()
#Put them all on one graph
#pdf(file="graphs/AllAvgHtchBtwnInfCntrl.pdf")
plot(iPLegg$xbar, type="o", main="Average Hatched Eggs Between Infected and Control Insects",
ylab="Number of Hatched Insects", xlab="Week in Study", col=2, pch=18, lty=1, ylim=c(0,10))
lines(cPLvia$xbar, type="o", pch=1, col=4, lty=1)
lines(iRAvia$xbar, type="o", pch=2, col=2, lty=2)
lines(cRAvia$xbar, type="o", pch=2, col=4, lty=2)
lines(iRBvia$xbar, type="o", pch=3, col=2, lty=3)
lines(cRBvia$xbar, type="o", pch=3, col=4, lty=3)
legend("topright", c("Pilot Infected","Pilot Controls", "Rep1 Infected",
"Rep1 Controls", "Rep2 Infected", "Rep2 Controls"),
col=c(2,4,2,4,2,4), pch=c(1,1,2,2,3,3), lty=c(1,1,2,2,3,3))
#dev.off()
###plotting the medians
##lets make the table with the total medians and then medians with the mean
#Lets start with the median plots for eggs and such
par(mfrow=c(1,1))
#pdf()
plot(infegg$medians, type="o", main="Median Eggs Laid Between Infected and Control Insects",
ylab="Number of eggs", xlab="Week in Study", col="darkorange1", pch=18)
lines(conegg$medians, type="o", pch=16, col="dodgerblue1")
legend("topright", c("infected","controls"), col=c("darkorange1", "dodgerblue1"), pch=c(18,16))
#dev.off()
plot(infvia$medians, type="o", main="Median Eggs Hatched Between Infected and Control Insects",
ylab="Number of eggs", xlab="Week in Study", col="darkorange1", pch=18)
lines(convia$medians, type="o", pch=16, col="dodgerblue1")
legend("topright", c("infected","controls"), col=c("darkorange1", "dodgerblue1"), pch=c(18,16))
#Put them al on one graph
plot(iPLegg$medians, type="o", main="Median Eggs Laid Between Infected and Control Insects",
ylab="Number of eggs", xlab="Week in Study", col=2, pch=18, lty=1, ylim=c(0,10))
lines(cPLegg$medians, type="o", pch=1, col=4, lty=1)
lines(iRAegg$medians, type="o", pch=2, col=2, lty=2)
lines(cRAegg$medians, type="o", pch=2, col=4, lty=2)
lines(iRBegg$medians, type="o", pch=3, col=2, lty=3)
lines(cRBegg$medians, type="o", pch=3, col=4, lty=3)
legend("topright", c("Pilot Infected","Pilot Controls", "Rep1 Infected",
"Rep1 Controls", "Rep2 Infected", "Rep2 Controls"),
col=c(2,4,2,4,2,4), pch=c(1,1,2,2,3,3), lty=c(1,1,2,2,3,3))
plot(iPLvia$medians, type="o", main="Median Eggs Hatched Between Infected and Control Insects",
ylab="Number of eggs", xlab="Week in Study", col=2, pch=18, lty=1, ylim=c(0,10))
lines(cPLvia$medians, type="o", pch=1, col=4, lty=1)
lines(iRAvia$medians, type="o", pch=2, col=2, lty=2)
lines(cRAvia$medians, type="o", pch=2, col=4, lty=2)
lines(iRBvia$medians, type="o", pch=3, col=2, lty=3)
lines(cRBvia$medians, type="o", pch=3, col=4, lty=3)
legend("topright", c("Pilot Infected","Pilot Controls", "Rep1 Infected",
"Rep1 Controls", "Rep2 Infected", "Rep2 Controls"),
col=c(2,4,2,4,2,4), pch=c(1,1,2,2,3,3), lty=c(1,1,2,2,3,3))
######################################################################
#=====================================================================
#Using Compile
#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
#Now all the data should be in place.  We can plot some more.
#Lets begin to make the box plots over time
#sete how eggs and hatching vary by date and week
#first limit cimfert to the pilot
#cimpilot<-which(cimfert$trial==0)
#cimfert <- cimfert[cimpilot,]
#rowna<-which(is.na(cimfert$ID)==TRUE)
#cimfert<-cimfert[-rowna,]
#par(mfrow=c(2,2))
eggweek<-lm(Compile$eggs ~Compile$week)
hatchweek<-lm(Compile$hatch ~Compile$week)
plot(Compile$week, Compile$eggs+rnorm(length(Compile$eggs), 0, 0.5), main="Eggs by Week")
abline(eggweek)
boxplot(Compile$eggs ~Compile$week, main="Eggs by Week")
plot(Compile$week, Compile$hatch+rnorm(length(Compile$hatch), 0, 0.5), main="Hatching by Week")
abline(hatchweek)
boxplot(Compile$hatch ~Compile$week, main="Hatching by Week")
#is this attempting to look at infection status at all>?
#pdf("")
#par(mfrow=c(2,4))
# plot(Compile$week, Compile$eggs, main="Eggs by Week")
# boxplot(Compile$eggs ~Compile$week, main="Eggs by Week")
# plot(Compile$week, Compile$hatch, main="Hatching by Week")
# boxplot(Compile$hatch ~Compile$week, main="Hatching by Week")
# plot(Compile$week, Compile$eggs, main="Eggs by Week")
# boxplot(Compile$eggs ~Compile$week, main="Eggs by Week")
# plot(Compile$week, Compile$hatch, main="Hatching by Week")
# boxplot(Compile$hatch ~Compile$week, main="Hatching by Week")
# #dev.off()
par(mfrow=c(1,1))
#pdf("graphs/NmbEggsByDateBox.pdf")
boxplot(Compile$eggs ~Compile$date, main="Eggs by Date")
#dev.off()
#pdf("graphs/NmbHtchByDateBox.pdf")
boxplot(Compile$hatch ~Compile$date, main="Hatching by Date")
#dev.off()
##lets makle a combined plot of the two groups together
enona<-which(is.na(Compile$eggs)==FALSE)
hnona<-which(is.na(Compile$hatch)==FALSE)
Compile$infected<-as.factor(Compile$infected)
Compile$week<-as.factor(Compile$week)
#the box plot for eggs laid
#pdf("graphs/NumEggsLaidByWeekYInfyCntlBox.pdf")
g<-ggplot(aes( y= eggs, x= week, fill = infected, na.rm=TRUE),
data= Compile[enona,]) +geom_boxplot(data=Compile[enona,])
g<-g+ggtitle("Distribution of Number of Eggs Laid by Infection Status Each Week")
g+scale_fill_manual(values=c("blue", "red"))
g
#dev.off()
#hatch plot
#pdf("graphs/NumEggsHtchByWeekyInfyCntrlBox.pdf")
h<-ggplot(aes( y= hatch, x= week, fill = infected, na.rm=TRUE),
data= Compile[hnona,])+geom_boxplot(data=Compile[hnona,])
h<-h+ggtitle("Distribution of Number of Eggs Hatched by Infection Status")
h
#dev.off()
#Other parts of this study show that life span changes depending on inf
#lets look at the number alive by week
alivetotweek <- c(1:length(unique(Compile$week))*NA)
aliveinfweek <- c(1:length(unique(Compile$week))*NA)
aliveconweek <- c(1:length(unique(Compile$week))*NA)
infected <- which(Compile$infected==1)
controlled <- which(Compile$infected==0)
#loop counts the number alive in each week (total, infected, and controls)
for (i in 1:length(unique(Compile$week))){
week<-which(Compile$week==i)
alivetotweek[i]<-sum(Compile$alive[week])
inf<-intersect(week, infected)
con<-intersect(week, controlled)
aliveinfweek[i]<-sum(Compile$alive[inf])
aliveconweek[i]<-sum(Compile$alive[con])
}
#pdf("graphs/NumInctsAlvByWeek.pdf")
plot(alivetotweek)
points(aliveinfweek, col="red")
points(aliveconweek, col="steelblue")
legend("topright", c("All Bugs","infected","controls"),
col=c("black","red", "steelblue"), pch=c(1,1,1))
#dev.off()
#a quick check seeing if alivetotweek is the sum of the other two.
#test<-aliveinfweek+aliveconweek
#testing<-data.frame(test, alivetotweek, aliveinfweek, aliveconweek)
#lets get a better view by looking at (percents)
which(cimfert$infected==1)
peraltotweek<-alivetotweek/(length(cimfert$ID))
peralinfweek <-aliveinfweek/(length(which(cimfert$infected==1)))
peralconweek <-aliveconweek/(length(which(cimfert$infected==0)))
#pdf("graphs/PerAlvInsctsByWeek.pdf")
plot(peraltotweek, col="black", xlab="Proportion Alive", ylab="Week",
main="Proportion Alive in Infected and Controls by Week")
points(peralconweek, col="steelblue")
points(peralinfweek, col="red")
legend("topright", c("All Bugs","infected","controls"),
col=c("black","red", "steelblue"), pch=c(1,1,1))
#dev.off()
#lets do something similar to see the number of egg events
eggetotweek <- c(1:length(unique(Compile$week))*NA)
eggeinfweek <- c(1:length(unique(Compile$week))*NA)
eggeconweek <- c(1:length(unique(Compile$week))*NA)
for (i in 1:length(unique(Compile$week))){
week<-which(Compile$week==i)
eggetotweek[i]<-sum(Compile$eggevent[week], na.rm=TRUE)
inf<-intersect(week, infected)
con<-intersect(week, controlled)
eggeinfweek[i]<-sum(Compile$eggevent[inf], na.rm=TRUE)
eggeconweek[i]<-sum(Compile$eggevent[con], na.rm=TRUE)
}
plot(eggetotweek)
points(eggeinfweek, col="red")
points(eggeconweek, col="steelblue")
legend("topright", c("infected","controls"),
col=c("red", "steelblue"), pch=c(1,1))
#lets get a better view by looking at percents
peregeinfweek<-eggeinfweek/length(infect)
peregeconweek<-eggeconweek/length(controls)
plot(peregeinfweek, type="o", col="red", xlab="Week", ylab="Proportion of Insects that Laid Eggs",
main="Proportion Insects that Laid in Infected and Controls by Week")
lines(peregeconweek, col="steelblue", type="o")
legend("topright", c("infected","controls"),
col=c("red", "steelblue"), pch=c(1,1))
#now we need to see proportion of alive insects
proeggeinfweek<-eggeinfweek/aliveinfweek
proeggeconweek<-eggeconweek/aliveconweek
##see if we can add Confidence Intervals below
#pdf("PerAlvInsctsLaidEggsbyWeek")
plot(proeggeinfweek, type="o", col="red", xlab="Week", ylab="Proportion of Alive Insects that Laid Eggs",
main="Proportion of Alive Insects that Laid in Infected and Controls by Week")
lines(proeggeconweek, col="steelblue")
legend("bottomleft", c("infected","controls"),
col=c("red", "steelblue"), pch=c(1,1))
# dev.off()
#now to do that with the total number of eggs.
eggstotweek <- c(1:length(unique(Compile$week))*NA)
eggsinfweek <- c(1:length(unique(Compile$week))*NA)
eggsconweek <- c(1:length(unique(Compile$week))*NA)
for (i in 1:length(unique(Compile$week))){
week<-which(Compile$week==i)
eggstotweek[i]<-sum(Compile$eggs[week], na.rm=TRUE)
inf<-intersect(week, infected)
con<-intersect(week, controlled)
eggsinfweek[i]<-sum(Compile$eggs[inf], na.rm=TRUE)
eggsconweek[i]<-sum(Compile$eggs[con], na.rm=TRUE)
}
plot(eggstotweek)
points(eggsinfweek, col="red")
points(eggsconweek, col="steelblue")
legend("topright", c("infected","controls"),
col=c("red", "steelblue"), pch=c(1,1))
#lets get a better view by looking at percents
peregsinfweek<-eggsinfweek/length(infect)
peregsconweek<-eggsconweek/length(controls)
plot(peregsinfweek, type="o", col="red", xlab="Week", ylab="Number of Eggs Laid Per Insect",
main="Eggs Laid Per Insect by Week")
lines(peregsconweek, col="steelblue")
legend("topright", c("infected","controls"),
col=c("red", "steelblue"), pch=c(1,1))
#now we need to see proportion of alive insects
proeggsinfweek<-eggsinfweek/aliveinfweek
proeggsconweek<-eggsconweek/aliveconweek
par(mfrow=c(1,1))
#  pdf(graphs/NmbEggsByAlvInsctbyWeekYInfyCont.pdf)
#consider how to add CI's
plot(proeggsinfweek, type="o", col="red", xlab="Week", ylab="Num Eggs Per Alive Insect",
main="Number of Eggs Per Alive Insect by Week and Treatment Group")
lines(proeggsconweek, col="steelblue", type="o")
legend("topright", c("infected","controls"),
col=c("red", "steelblue"), pch=c(1,1))
#  dev.off()
#Now lets observe percentage of insects hatching
plot(Compile$week, Compile$perferc, na.rm=TRUE)
######################################################################
#plot humidity and temperature over time
Compile$avhum <- as.numeric(Compile$avhum)
plot(Compile$date, Compile$avhum,col="dodgerblue", ylim=c(24,60),
main="Temperature and Humidity", ylab="Relative Humidity(%) and Temperature(C)",
xlab="Date")
points(Compile$date, Compile$avtemp, col="tomato")
legend("topleft", c("Humidity", "Temperature"), text.col=c("dodgerblue","tomato"))
#eggs laid by humidity
humeggs<-lm(Compile$eggs ~Compile$avhum)
plot(Compile$avhum, Compile$eggs+rnorm(length(Compile$eggs), 0, 0.5),
main="Eggs by Humidity", ylab="Number of Eggs",
xlab="Humidity(%)")
abline(humeggs)
#summary(humeggs)
#eggs by average hum
egghum<-ggplot(aes( y= eggs, x= avhum, na.rm=TRUE),
data=Compile[enona,])+geom_point(data=Compile[enona,])
egghum<-egghum+ggtitle("Number of Eggs Laid by Average Humidity and Infection Status")
egghum<-egghum+facet_grid(. ~infected)+geom_smooth(method= "lm")
egghum
eghum<-glm(eggs ~infected*avhum, data=Compile)
#eggs by average high hum
egghumavhigh<-ggplot(aes( y= eggs, x= avhumhigh, na.rm=TRUE),
data=Compile[enona,])+geom_point(data=Compile[enona,])
egghumavhigh<-egghumavhigh+ggtitle("Number of Eggs Laid by Average Max Humidity and Infection Status")
egghumavhigh<-egghumavhigh+facet_grid(. ~infected)+geom_smooth(method= "lm")
egghumavhigh
#eggs by average low hum
egghumavlow<-ggplot(aes( y= eggs, x= avhumlow, na.rm=TRUE),
data=Compile[enona,])+geom_point(data=Compile[enona,])
egghumavlow<-egghumavlow+ggtitle("Number of Eggs Laid by Average Low Humidity and Infection Status")
egghumavlow<-egghumavlow+facet_grid(. ~infected)+geom_smooth(method= "lm")
egghumavlow
#eggs by week max high
egghumhigh<-ggplot(aes( y= eggs, x= hummax, na.rm=TRUE),
data=Compile[enona,])+geom_point(data=Compile[enona,])
egghumhigh<-egghumhigh+ggtitle("Number of Eggs Laid by Max Humidity and Infection Status")
egghumhigh<-egghumhigh+facet_grid(. ~infected)+geom_smooth(method= "lm")
egghumhigh
#eggs by week low high
egghumlow<-ggplot(aes( y= eggs, x= hummin, na.rm=TRUE),
data=Compile[enona,])+geom_point(data=Compile[enona,])
egghumlow<-egghumlow+ggtitle("Number of Eggs Laid by Low Humidity and Infection Status")
egghumlow<-egghumlow+facet_grid(. ~infected)+geom_smooth(method= "lm")
egghumlow
#eggs by hum diff
egghumdiff<-ggplot(aes( y= eggs, x= humdiff, na.rm=TRUE),
data=Compile[enona,])+geom_point(data=Compile[enona,])
egghumdiff<-egghumdiff+ggtitle("Number of Eggs Laid by Largest Humidity Difference and Infection Status")
egghumdiff<-egghumdiff+facet_grid(. ~infected)+geom_smooth(method= "lm")
egghumdiff
#lets compare which of these would be best for the model
#each show an interaction between hum and infection status. (maybe tempdiff less so)
mavhum<-glm(eggs~avhum*infected, data=Compile)#13910
mavhumhigh<-glm(eggs~avhumhigh*infected, data=Compile)#13910
mavhumlow<-glm(eggs~avhumlow*infected, data=Compile)#13910
mhummax<-glm(eggs~hummax*infected, data=Compile)#13930#we can kill this
mhummin<-glm(eggs~hummin*infected, data=Compile)#13910
mhumdiff<-glm(eggs~humdiff*infected, data=Compile)#13960 #we can kill this too
avhhumpdiff<-glm(eggs~avhum*+humdiff, data=Compile)#14020 (adding humdiff doesn't help)
avhumlm<-lm(eggs~avhum, data=Compile)
avhumhighlm<-lm(eggs~avhumhigh, data=Compile)
humminlm<-lm(eggs~hummin, data=Compile) #
################################################
#same for temp
#plot temperature by eggs
Compile$avtemp <- as.character(Compile$avtemp)
tempeggs<-lm(Compile$eggs ~Compile$avtemp)
plot(Compile$avtemp, Compile$eggs,
main="Eggs by Temperature", ylab="Number of Eggs",
xlab="Temperature(C)")
#eggs by average temp
eggtemp<-ggplot(aes( y= eggs, x= avtemp, na.rm=TRUE),
data=Compile[enona,])+geom_point(data=Compile[enona,])
eggtemp<-eggtemp+ggtitle("Number of Eggs Laid by Average Temperature and Infection Status")
eggtemp<-eggtemp+facet_grid(. ~infected)+geom_smooth(method= "lm")
eggtemp
#eggs by average high hum
eggtempavhigh<-ggplot(aes( y= eggs, x= avtemphigh, na.rm=TRUE),
data=Compile[enona,])+geom_point(data=Compile[enona,])
eggtempavhigh<-eggtempavhigh+ggtitle("Number of Eggs Laid by Avg High Temp and Infection Status")
eggtempavhigh<-eggtempavhigh+facet_grid(. ~infected)+geom_smooth(method= "lm")
eggtempavhigh
#eggs by average low hum
eggtempavlow<-ggplot(aes( y= eggs, x= avtemplow, na.rm=TRUE),
data=Compile[enona,])+geom_point(data=Compile[enona,])
eggtempavlow<-eggtempavlow+ggtitle("Number of Eggs Laid by Avg Low Temperature and Infection Status")
eggtempavlow<-eggtempavlow+facet_grid(. ~infected)+geom_smooth(method= "lm")
eggtempavlow
#eggs by week max high
eggtemphigh<-ggplot(aes( y= eggs, x= tempmax, na.rm=TRUE),
data=Compile[enona,])+geom_point(data=Compile[enona,])
eggtemphigh<-eggtemphigh+ggtitle("Number of Eggs Laid by Max Temperature and Infection Status")
eggtemphigh<-eggtemphigh+facet_grid(. ~infected)+geom_smooth(method= "lm")
eggtemphigh
#eggs by week low high
eggtemplow<-ggplot(aes( y= eggs, x= tempmin, na.rm=TRUE),
data=Compile[enona,])+geom_point(data=Compile[enona,])
eggtemplow<-egghumlow+ggtitle("Number of Eggs Laid by Low Temperature and Infection Status")
eggtemplow<-egghumlow+facet_grid(. ~infected)+geom_smooth(method= "lm")
eggtemplow
#eggs by temp diff
eggtempdiff<-ggplot(aes( y= eggs, x= tempdiff, na.rm=TRUE),
data=Compile[enona,])+geom_point(data=Compile[enona,])
eggtempdiff<-eggtempdiff+ggtitle("Number of Eggs Laid by Largest Temperature Difference and Infection Status")
eggtempdiff<-eggtempdiff+facet_grid(. ~infected)+geom_smooth(method= "lm")
eggtempdiff
Compile$avtemp <- as.numeric(Compile$avtemp)
eggtem<-ggplot(aes( y= eggs, x= avtemp, na.rm=TRUE),
data=Compile[enona,])+geom_point(data=Compile[enona,])
eggtem<-eggtem+ggtitle("Number of Eggs Laid by Temperature and Infection Status")
eggtem<-eggtem+facet_grid(. ~infected)+geom_smooth(method= "lm")
eggtem
#lets compare to see what would be best for model
#these don't have as important interactions
lmavtemp<-lm(eggs~avtemp, data=Compile) #Rsq=0.017
lmavtemphigh<-lm(eggs~avtemphigh, data=Compile)#Rsq=0.02
lmavtemplow<-lm(eggs~avtemplow, data=Compile)#Rsq=0.010
lmavmin<-lm(eggs~tempmin, data=Compile)#Rsq=0.011
lmtempmax<-lm(eggs~tempmax, data=Compile)#Rsq=0.010
lmtempdiff<-lm(eggs~tempdiff, data=Compile)#Rsq=0.009
mavtemp<-glm(eggs~avtemp+infected, data=Compile) #AIC=13900
mavtemphigh<-glm(eggs~avtemphigh*infected, data=Compile)#AIC=13900
mavtemplow<-glm(eggs~avtemplow*infected, data=Compile)#AIC=13920
mavmin<-glm(eggs~tempmin*infected, data=Compile)
mtempmax<-glm(eggs~tempmax*infected, data=Compile)
mtempdiff<-glm(eggs~tempdiff*infected, data=Compile)
###################
#Now for hatching
#hatch by humidity
humhatch<-lm(Compile$hatch ~Compile$avhum)
plot(Compile$avhum, Compile$hatch,
main="Hatching by Humidity", ylab="Number of Eggs",
xlab="Humidity(%)")
#hatch by average hum
hchhum<-ggplot(aes( y= hatch, x= avhum, na.rm=TRUE),
data=Compile[hnona,])+geom_point(data=Compile[hnona,])
hchhum<-hchhum+ggtitle("Number of Eggs Hatched by Humidity and Infection Status")
hchhum<-hchhum+facet_grid(. ~infected)+geom_smooth(method= "lm")
hchhum
#hatch average high hum
hchhumavhigh<-ggplot(aes( y= hatch, x= avhumhigh, na.rm=TRUE),
data=Compile[hnona,])+geom_point(data=Compile[hnona,])
hchhumavhigh<-hchhumavhigh+ggtitle("Number of Eggs Hatched by Max Humidity and Infection Status")
hchhumavhigh<-hchhumavhigh+facet_grid(. ~infected)+geom_smooth(method= "lm")
hchhumavhigh
#hatch by average low hum
hchhumavlow<-ggplot(aes( y= hatch, x= avhumlow, na.rm=TRUE),
data=Compile[hnona,])+geom_point(data=Compile[hnona,])
hchhumavlow<-hchhumavlow+ggtitle("Number of Eggs Hatched by Average Low Humidity and Infection Status")
hchhumavlow<-hchhumavlow+facet_grid(. ~infected)+geom_smooth(method= "lm")
hchhumavlow
#hatch by week max high
hchhumhigh<-ggplot(aes( y= hatch, x= hummax, na.rm=TRUE),
data=Compile[hnona,])+geom_point(data=Compile[hnona,])
hchhumhigh<-hchhumhigh+ggtitle("Number of Eggs Hatched by Max Humidity and Infection Status")
hchhumhigh<-hchhumhigh+facet_grid(. ~infected)+geom_smooth(method= "lm")
hchhumhigh
#hatch by week low high
hchhumlow<-ggplot(aes( y= hatch, x= hummin, na.rm=TRUE),
data=Compile[hnona,])+geom_point(data=Compile[hnona,])
hchhumlow<-hchhumlow+ggtitle("Number of Eggs Hatched by Low Humidity and Infection Status")
hchhumlow<-hchhumlow+facet_grid(. ~infected)+geom_smooth(method= "lm")
hchhumlow
#hatch by hum diff
hchhumdiff<-ggplot(aes( y= hatch, x= humdiff, na.rm=TRUE),
data=Compile[hnona,])+geom_point(data=Compile[hnona,])
hchhumdiff<-hchhumdiff+ggtitle("Number of Eggs Hatced by Largest Humidity Difference and Infection Status")
hchhumdiff<-hchhumdiff+facet_grid(. ~infected)+geom_smooth(method= "lm")
hchhumdiff
############################
#hatch by temp
temphatch<-lm(Compile$hatch ~Compile$avtemp)
plot(Compile$avtemp, Compile$hatch,
main="Hatching by Temperature", ylab="Number of Eggs",
xlab="Temperature(C)")
#hatch by average temp
hchtemp<-ggplot(aes( y= hatch, x= avtemp, na.rm=TRUE),
data=Compile[hnona,])+geom_point(data=Compile[hnona,])
hchtemp<-hchtemp+ggtitle("Number of Eggs Hatched by Temp and Infection Status")
hchtemp<-hchtemp+facet_grid(. ~infected)+geom_smooth(method= "lm")
hchtemp
#hatch average high temp
hchtempavhigh<-ggplot(aes( y= hatch, x= avtemphigh, na.rm=TRUE),
data=Compile[hnona,])+geom_point(data=Compile[hnona,])
hchtempavhigh<-hchtempavhigh+ggtitle("Number of Eggs Hatched by Max Temp and Infection Status")
hchtempavhigh<-hchtempavhigh+facet_grid(. ~infected)+geom_smooth(method= "lm")
hchtempavhigh
#hatch by average low temp
hchtempavlow<-ggplot(aes( y= hatch, x= avtemplow, na.rm=TRUE),
data=Compile[hnona,])+geom_point(data=Compile[hnona,])
hchtempavlow<-hchtempavlow+ggtitle("Number of Eggs Hatched by Average Low Temp and Infection Status")
hchtempavlow<-hchtempavlow+facet_grid(. ~infected)+geom_smooth(method= "lm")
hchtempavlow
#hatch by week max high
hchtemphigh<-ggplot(aes( y= hatch, x= tempmax, na.rm=TRUE),
data=Compile[hnona,])+geom_point(data=Compile[hnona,])
hchtemphigh<-hchtemphigh+ggtitle("Number of Eggs Hatched by Max Temp and Infection Status")
hchtemphigh<-hchtemphigh+facet_grid(. ~infected)+geom_smooth(method= "lm")
hchtemphigh
#hatch by week min low
hchtemplow<-ggplot(aes( y= hatch, x= tempmin, na.rm=TRUE),
data=Compile[hnona,])+geom_point(data=Compile[hnona,])
hchtemplow<-hchtemplow+ggtitle("Number of Eggs Hatched by Low Temp and Infection Status")
hchtemplow<-hchtemplow+facet_grid(. ~infected)+geom_smooth(method= "lm")
hchtemplow
#hatch by hum diff
hchtempdiff<-ggplot(aes( y= hatch, x= tempdiff, na.rm=TRUE),
data=Compile[hnona,])+geom_point(data=Compile[hnona,])
hchtempdiff<-hchtempdiff+ggtitle("Number of Eggs Hatced by Largest Temp Difference and Infection Status")
hchtempdiff<-hchtempdiff+facet_grid(. ~infected)+geom_smooth(method= "lm")
hchtempdiff
################################
# ##For each time line
# glm(cases~rhs(data$year,2003)+lhs(data$year,2003)+ offset(log(population)), data=data,
#subset=28:36, family=poisson())
# #Now lets make a graph of Eggs by week
# infected<-which(Compile$infected==1)
# controled<-which(Compile$infected==0)
# uniquebugs<-unique(Compile$id)
# plot(Compile$week[infected], Compile$eggs[infected]+rnorm(length(Compile$eggs[infected]), 0.5, 1), col="red")
#
# #Now lets make a graphs o week and date by eggs of infected insects
# infected<-which(Compile$infected==1)
# controled<-which(Compile$infected==0)
# uniquebugs<-unique(Compile$id)
# plot(Compile$week[infected], Compile$eggs[infected], col="red")
# plot(Compile$date[infected], Compile$eggs[infected], col="red")
#Compare infected hatch and by week.
par(mfrow=c(2,4))
#infected
#pdf(file="graphs/EggsandHatchvsWeekboxanddotplots.pdf")
plot(Compile$week[infected], Compile$eggs[infected], main="Infected Eggs Laid by Week",
ylab="Weeks", xlab="Eggs")
boxplot(Compile$eggs[infected] ~c(Compile$week[infected]), main="Infected Eggs Laid by Week",
ylab="Weeks", xlab="Eggs")
plot(Compile$week[infected], Compile$hatch[infected], main="Infected Eggs Hatched by Week",
ylab="Weeks", xlab="Eggs")
boxplot(Compile$hatch[infected] ~Compile$week[infected], main="Infected Eggs Hatched by Week",
ylab="Weeks", xlab="Eggs")
#not infected
plot(Compile$week[controled], Compile$eggs[controled], main="Control Eggs Laid by Week",
ylab="Weeks", xlab="Eggs")
boxplot(Compile$eggs[controled] ~Compile$week[controled], main="Control Eggs Laid by Week",
ylab="Weeks", xlab="Eggs")
plot(Compile$week[controled], Compile$hatch[controled], main="Control Eggs Hatched by Week",
ylab="Weeks", xlab="Eggs")
boxplot(Compile$hatch[controled] ~Compile$week[controled], main="Control Eggs Hatched by Week",
ylab="Weeks", xlab="Eggs")
#dev.off()
#create a factor for mice so that
mice<-unique(Compile$mouse)
mouseidnums<-c(1:length(mice))
mousetable<-data.frame(mice,mouseidnum)
mousetable$mouseidnum<-as.factor(mousetable$mouseidnum)
CompileRD$mouseidnum<-CompileRD$trial*0
for(i in 1:length(mice)){
micenumi<-which(mousetable$mouseidnum==i)
micematch<-which(CompileRD$mouse==mousetable$mice[micenumi])
CompileRD$mouseidnum[micematch]<-i
}
write.csv(Compile,"CompiledFertilityData.csv")
